<!DOCTYPE html>
<html lang="en" dir="ltr" typeof="bibo:Document w3p:REC" about="" property="dcterms:language" content="en" prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#">
<head>
    <!--link href="http://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet" type="text/css" charset="utf-8"-->
    <title>FIDO Security Reference</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <!--
	=== NOTA BENE ===
	For the three scripts below, if your spec resides on dev.w3 you can check them
	out in the same tree and use relative links so that they'll work offline,
      -->
    
    
    

  <style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #ff4500;
}

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #003a7c;
}

.simple th {
    background: #003a7c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

@media print {
    .removeOnSave {
        display: none;
    }
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title { color: #2b2; }
div.issue-title span, div.note-title span {
    text-transform: uppercase;
}
div.note, div.issue {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .issue > p:first-child { margin-top: 0 }
.issue, .note {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.issue { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note {
    border-color: #52e052;
    background: #e9fbe9;
}


</style><link rel="stylesheet" href="resources/FIDO-PS.css"><!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--></head>
  <body class="h-entry" style="" role="document" id="respecDocument"><div class="head" role="contentinfo" id="respecHeader">
  <p>
    
      <a href="https://www.fidoalliance.org/"><img width="250" id="toplogo" src="resources/logo.png" alt="FIDO Alliance"></a>
    
  </p>
  <h1 class="title p-name" id="title" property="dcterms:title">FIDO Security Reference</h1>
  
  <h2 property="dcterms:issued" datatype="xsd:dateTime" content="2017-09-27T07:00:00.000Z" id="fido-alliance-proposed-standard-27-september-2017"><abbr title="FIDO Alliance">FIDO Alliance</abbr> Proposed Standard <time class="dt-published" datetime="2017-09-27">27 September 2017</time></h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a class="u-url" href="https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-security-ref-v2.0-ps-20170927.html">https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-security-ref-v2.0-ps-20170927.html</a></dd>
      <!--<dt>Latest published version:</dt>
      <dd><a href='https://fidoalliance.org/specs/fido-security-ref/'>https://fidoalliance.org/specs/fido-security-ref/</a></dd>
    
    -->
    
    
    
    
    
      <dt>Previous version:</dt>
      <dd><a rel="dcterms:replaces" href="https://fidoalliance.org/specs/fido-v2.0-rd-20161004/fido-security-ref-v2.0-rd-20161004.html">https://fidoalliance.org/specs/fido-v2.0-rd-20161004/fido-security-ref-v2.0-rd-20161004.html</a></dd>
    
    
    <dt>Editor:</dt>
    <dd class="p-author h-card vcard" rel="bibo:editor" inlist=""><span typeof="foaf:Person"><a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Rolf Lindemann" href="mailto:rolf@noknok.com">Rolf Lindemann</a>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.noknok.com/">Nok Nok Labs, Inc.</a></span>
</dd>

    
      <dt>Contributors:</dt>
      <dd class="p-author h-card vcard" rel="dcterms:contributor"><span typeof="foaf:Person"><a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Davit Baghdasaryan" href="mailto:davit@noknok.com">Davit Baghdasaryan</a>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.noknok.com/">Nok Nok Labs, Inc.</a></span>
</dd>
<dd class="p-author h-card vcard" rel="dcterms:contributor"><span typeof="foaf:Person"><a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Brad Hill" href="mailto:bhill@paypal.com">Brad Hill</a>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.paypal.com/">PayPal, Inc.</a></span>
</dd>
<dd class="p-author h-card vcard" rel="dcterms:contributor"><span typeof="foaf:Person"><a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Dr. Joshua E. Hill" href="mailto:jhill@infogard.com">Dr. Joshua E. Hill</a>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://infogard.com/">InfoGard Laboratories</a></span>
</dd>
<dd class="p-author h-card vcard" rel="dcterms:contributor"><span typeof="foaf:Person"><a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Douglas Biggs" href="mailto:dbiggs@infogard.com">Douglas Biggs</a>, <a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://infogard.com/">InfoGard Laboratories</a></span>
</dd>

    
    
  </dl>
  
  
  
    <p>
      The English version of this specification is the only normative version. Non-normative
      <a href="https://www.fidoalliance.org/specifications/translation/">translations</a> may also be available.
    </p>
  
  
    
      <p class="copyright">
        Copyright ©
        2013-2017
        
        <a href="https://www.fidoalliance.org/"><abbr title="FIDO Alliance">FIDO Alliance</abbr></a>
        All Rights Reserved.
      </p>
    
  
  <hr>
</div>

    <!-- only put content here if you want a custom status of document not
	 the specification-maturity-appropriate boilerplate -->
    

    <section id="abstract" class="introductory" property="dcterms:abstract" datatype="" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h2 aria-level="1" role="heading" id="h2_abstract">Abstract</h2><p>
      This document analyzes the security properties of the FIDO UAF and U2F families of
      protocols.
    </p></section><section id="sotd" class="introductory" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h2 aria-level="1" role="heading" id="h2_sotd">Status of This Document</h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication.
          Other documents may supersede this document. A list of current <abbr title="FIDO Alliance">FIDO Alliance</abbr> publications and the
          latest revision of this technical report can be found in the <a href="https://www.fidoalliance.org/specifications/"><abbr title="FIDO Alliance">FIDO Alliance</abbr> specifications index</a> at
          https://www.fidoalliance.org/specifications/.
        </em>
        </p>
        
        <p>
          This document was published by the <a href="https:/fidoalliance.org/"><abbr title="FIDO Alliance">FIDO Alliance</abbr></a> as a Proposed Standard.
          
          
            If you wish to make comments regarding this document, please 
            <a href="https://fidoalliance.org/contact">Contact Us</a>.
          
          
          
          
            All comments are welcome.
          
        </p>
        
	
	
	
  
        
          <p>
	    Implementation of certain elements of this Specification may require licenses under third party intellectual 
	    property rights, including without limitation, patent rights. The <abbr title="FIDO Alliance">FIDO Alliance</abbr>, Inc. and its Members
            and any other contributors to the Specification are not, and shall not be held, responsible in any manner
            for identifying or failing to identify any or all such third party intellectual property rights.
	  </p>
	  <p>
	    THIS FIDO ALLIANCE SPECIFICATION IS PROVIDED “AS IS” AND WITHOUT ANY 
            WARRANTY OF ANY KIND, INCLUDING, WITHOUT LIMITATION, ANY EXPRESS OR IMPLIED
	    WARRANTY OF NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A
	    PARTICULAR PURPOSE.
          </p>
        
        
          <p>
            This document has been reviewed by FIDO Aliance Members
            and is endorsed as a Proposed Standard.
            It is a stable document and may be used as reference material or cited from another
            document. <abbr title="FIDO Alliance">FIDO Alliance</abbr>'s role in making the Recommendation is to draw attention to the
            specification and to promote its widespread deployment.
          </p>
        
        
        
      
    
  
</section><section id="toc"><h2 class="introductory" aria-level="1" role="heading" id="h2_toc">Table of Contents</h2><ul class="toc" role="directory" id="respecContents"><li class="tocline"><a href="#notation" class="tocxref"><span class="secno">1. </span>Notation</a><ul class="toc"><li class="tocline"><a href="#key-words" class="tocxref"><span class="secno">1.1 </span>Key Words</a></li></ul></li><li class="tocline"><a href="#introduction" class="tocxref"><span class="secno">2. </span>Introduction</a><ul class="toc"><li class="tocline"><a href="#intended-audience" class="tocxref"><span class="secno">2.1 </span>Intended Audience</a></li></ul></li><li class="tocline"><a href="#attack-classification" class="tocxref"><span class="secno">3. </span>Attack Classification</a></li><li class="tocline"><a href="#fido-security-goals" class="tocxref"><span class="secno">4. </span>FIDO Security Goals</a><ul class="toc"><li class="tocline"><a href="#assets-to-be-protected" class="tocxref"><span class="secno">4.1 </span>Assets to be Protected</a></li></ul></li><li class="tocline"><a href="#fido-security-measures" class="tocxref"><span class="secno">5. </span>FIDO Security Measures</a><ul class="toc"><li class="tocline"><a href="#relation-between-measures-and-goals" class="tocxref"><span class="secno">5.1 </span>Relation between Measures and Goals</a></li></ul></li><li class="tocline"><a href="#fido-security-assumptions" class="tocxref"><span class="secno">6. </span>FIDO Security Assumptions</a><ul class="toc"><li class="tocline"><a href="#discussion" class="tocxref"><span class="secno">6.1 </span>Discussion</a></li></ul></li><li class="tocline"><a href="#threat-analysis" class="tocxref"><span class="secno">7. </span>Threat Analysis</a><ul class="toc"><li class="tocline"><a href="#threats-to-client-side" class="tocxref"><span class="secno">7.1 </span>Threats to Client Side</a><ul class="toc"><li class="tocline"><a href="#exploiting-user-s-pattern-matching-weaknesses" class="tocxref"><span class="secno">7.1.1 </span>Exploiting User’s pattern matching weaknesses</a></li><li class="tocline"><a href="#threats-to-the-user-device-fido-client-and-relying-party-client-applications" class="tocxref"><span class="secno">7.1.2 </span>Threats to the User Device, FIDO Client and Relying Party Client Applications</a></li><li class="tocline"><a href="#creating-a-fake-client" class="tocxref"><span class="secno">7.1.3 </span>Creating a Fake Client</a></li><li class="tocline"><a href="#threats-to-fido-authenticator" class="tocxref"><span class="secno">7.1.4 </span>Threats to FIDO Authenticator</a></li><li class="tocline"><a href="#threats-to-relying-party" class="tocxref"><span class="secno">7.1.5 </span>Threats to Relying Party</a><ul class="toc"><li class="tocline"><a href="#threats-to-fido-server-data" class="tocxref"><span class="secno">7.1.5.1 </span>Threats to FIDO Server Data</a></li></ul></li><li class="tocline"><a href="#threats-to-the-secure-channel-between-client-and-relying-party" class="tocxref"><span class="secno">7.1.6 </span>Threats to the Secure Channel between Client and Relying Party</a><ul class="toc"><li class="tocline"><a href="#exploiting-weaknesses-in-the-secure-transport-of-fido-messages" class="tocxref"><span class="secno">7.1.6.1 </span>Exploiting Weaknesses in the Secure Transport of FIDO Messages</a></li></ul></li><li class="tocline"><a href="#threats-to-the-infrastructure" class="tocxref"><span class="secno">7.1.7 </span>Threats to the Infrastructure</a><ul class="toc"><li class="tocline"><a href="#threats-to-fido-authenticator-manufacturers" class="tocxref"><span class="secno">7.1.7.1 </span>Threats to FIDO Authenticator Manufacturers</a></li><li class="tocline"><a href="#threats-to-fido-server-vendors" class="tocxref"><span class="secno">7.1.7.2 </span>Threats to FIDO Server Vendors</a></li><li class="tocline"><a href="#threats-to-fido-metadata-service-operators" class="tocxref"><span class="secno">7.1.7.3 </span>Threats to FIDO Metadata Service Operators</a></li></ul></li><li class="tocline"><a href="#threats-specific-to-second-factor-authenicators-uaf-u2f" class="tocxref"><span class="secno">7.1.8 </span>Threats Specific to Second Factor Authenicators (UAF / U2F)</a></li></ul></li><li class="tocline"><a href="#acknowledgements" class="tocxref"><span class="secno">7.2 </span>Acknowledgements</a></li></ul></li><li class="tocline"><a href="#references" class="tocxref"><span class="secno">A. </span>References</a><ul class="toc"><li class="tocline"><a href="#informative-references" class="tocxref"><span class="secno">A.1 </span>Informative references</a></li></ul></li></ul></section>

    <section id="notation">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_notation"><span class="secno">1. </span>Notation</h2>

      <p>Type names, attribute names and element names are written as <code>code</code>.</p>

      <p>String literals are enclosed in “”, e.g. “UAF-TLV”.</p>

      <p>In formulas we use “|” to denote byte wise concatenation
	operations.</p>

      <p>UAF specific terminology used in this document is defined in
	[<cite><a class="bibref" href="#bib-FIDOGlossary">FIDOGlossary</a></cite>].</p>

	<section id="key-words">
	  <h3 aria-level="2" role="heading" id="h3_key-words"><span class="secno">1.1 </span>Key Words</h3> 

	  <p>The key words “<em class="rfc2119" title="MUST">MUST</em>”, “<em class="rfc2119" title="MUST NOT">MUST NOT</em>”, “<em class="rfc2119" title="REQUIRED">REQUIRED</em>”, “<em class="rfc2119" title="SHALL">SHALL</em>”, “<em class="rfc2119" title="SHALL
	    NOT">SHALL
	    NOT</em>”, “<em class="rfc2119" title="SHOULD">SHOULD</em>”, “<em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em>”, “<em class="rfc2119" title="RECOMMENDED">RECOMMENDED</em>”, “<em class="rfc2119" title="MAY">MAY</em>”, and
	    “<em class="rfc2119" title="OPTIONAL">OPTIONAL</em>” in this document are to be interpreted as
	    described in [<cite><a class="bibref" href="#bib-RFC2119">RFC2119</a></cite>].</p>
	</section>
    </section>

    <section id="introduction">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_introduction"><span class="secno">2. </span>Introduction</h2>
      This document analyzes the security properties of the FIDO UAF and U2F families of
      protocols. Although a brief architectural summary is provided below, readers should familiarize
      themselves with the the FIDO Glossary of Terms [<cite><a class="bibref" href="#bib-FIDOGlossary">FIDOGlossary</a></cite>] for definitions
      of terms used throughout. For technical details of various aspects of the architecture,
      readers should refer to the <abbr title="FIDO Alliance">FIDO Alliance</abbr> specifications in the Bibliography.

      <figure id="FIDOReferenceArchitecture">	  
	<img src="./img/fido-security-ref-architecture.png" onerror="./img/fido-security-ref-architecture.png" alt="FIDO Reference Architecture">
	<figcaption>Fig. <span class="figno">1</span> <span class="fig-title">FIDO Reference Architecture</span></figcaption>
      </figure>
      


      Conceptually, FIDO involves a conversation between a computing environment controlled
      by a Relying Party and one controlled by the user to be authenticated.
      The Relying Party's environment consists conceptually of at least a web server and the
      server-side portions of a web application, plus a FIDO Server.
      The FIDO Server has a trust store, containing the (public) trust anchors for the attestation
      of FIDO Authenticators.
      The users' environment, referred to as the FIDO user device, consists of one or more
      FIDO Authenticators, a piece of software called the FIDO Client that is the endpoint for
      UAF and U2F conversations, and User Agent software. The User Agent software may
      be a browser hosting a web application delivered by the Relying Party, or it may be a
      standalone application delivered by the Relying Party. In either case, the FIDO Client,
      while a conceptually distinct entity, may actually be implemented in whole or part within
      the boundaries of the User Agent. 

      <section id="intended-audience">
	<h3 aria-level="2" role="heading" id="h3_intended-audience"><span class="secno">2.1 </span>Intended Audience</h3>
	This document assumes a technical audience that is proficient with security analysis of
	computing systems and network protocols as well as the specifics of the FIDO architecture
	and protocol families. It discusses the security goals, security measures, security
	assumptions and a series of threats to FIDO systems, including the users' computing
	environment, the Relying Party's computing environment, and the supply chain, including
	the vendors of FIDO components.
      </section>
    </section>
    <section id="attack-classification">

      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_attack-classification"><span class="secno">3. </span>Attack Classification</h2>
      The following attacks all result in user impersonation if successful. However, they have 
      distinguishing characteristics which we use as the basis for attack classification:
      <ol>
	<li>Automated attacks not focused on the users systems, which affect the user.</li>
	<li>Automated attacks which are focused on the users' device and which are performed 
	  once and lead to the ability to impersonate 
	  the user on an on-going basis without involving him or his device directly.</li>
	<li>Automated attacks which involve the user or his device for each successful impersonation.</li>
	<li>Automated attacks to sessions authenticated by the user.</li>
	<li>Not automatable attacks to the user or his device which are performed once and lead 
	  to the ability to impersonate the user on an on-going basis without involving him 
	  or his device directly.</li>
	<li>Not automatable attacks to the user or his device which involve the user or his 
	  device for each successful impersonation.</li>
      </ol>

      
      <figure id="AttackClasses">	  
	<img src="./img/fido-security-ref-attack-classes.png" onerror="./img/fido-security-ref-attack-classes.png" alt="Attack Classes">
	<figcaption>Fig. <span class="figno">2</span> <span class="fig-title">Attack Classes</span></figcaption>
      </figure>

      The first four attack classes are considered scalable as they are nominally automatable.
      The attack classes 5 and 6 are not automatable; they involve some kind of manual/physical 
      interaction of the attacker with the user or his device.
      We will attribute the threats analyzed in this document with the related attack class (AC1 – AC6).
      <div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_1"><span>Note</span></div><ol class="">
	<li>FIDO uses asymmetric cryptography to protect against AC1.  
	  This gives control back to the user, i.e. when using good random numbers, the user’s 
	  authenticator can make breaking the key as hard as the underlying factoring 
	  (in the case of RSA) or discrete logarithm (in the case of DSA or ECDSA) problem.</li>
	<li>Once counter-measures for this kind of attack are commonly in place, attackers 
	  will likely focus on another attack class.</li>
	<li>The numbers at the attack classes do not imply a feasibility ranking of the 
	  related attacks, e.g. it is not necessarily more difficult to perform (<a href="#dfn-ac4" class="internalDFN">AC4</a>) 
	  than it is to perform (<a href="#dfn-ac3" class="internalDFN">AC3</a>).</li>
	<li>The user has almost no influence on the feasibility of attack class (<a href="#dfn-ac1" class="internalDFN">AC1</a>).  
	  This makes this attack class really bad.</li>
	<li>The concept of physical security (i.e. “protect your Authenticator from being stolen”), 
	  related to attack classes (<a href="#dfn-ac5" class="internalDFN">AC5</a>) and (<a href="#dfn-ac6" class="internalDFN">AC6</a>) is much better internalized by users than the 
	  concept of logical security, related to attack classes (<a href="#dfn-ac2" class="internalDFN">AC2</a>), (<a href="#dfn-ac3" class="internalDFN">AC3</a>) and (<a href="#dfn-ac4" class="internalDFN">AC4</a>).</li>
	<li>In order to protect against misuse of authenticated sessions (e.g. MITB attacks), 
	  the FIDO Authenticator must support the concept of transaction confirmation 
	  and the relying party must use it.</li>
	<li>For an attacker to succeed in impersonating the user, any attack class is sufficient.</li>
      </ol></div>
      
      <h2 id="attack-classes">Attack Classes</h2>
      We define the term scalable attack as any attack where the marginal cost of adding 
      an additional target is near zero and which leads to violations of the FIDO security goals. 
      <div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_2"><span>Note</span></div><p class=""> The first four attack classes (<a href="#dfn-ac1" class="internalDFN">AC1</a>, <a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac3" class="internalDFN">AC3</a>, and <a href="#dfn-ac4" class="internalDFN">AC4</a>) are considered scalable. 
	The last two attack classes (<a href="#dfn-ac5" class="internalDFN">AC5</a> and <a href="#dfn-ac6" class="internalDFN">AC6</a>) are not scalable and are performed as one-off 
	user/Relying Party style compromises. We will attribute the threats analyzed 
	in this document with the related attack class (<a href="#dfn-ac1" class="internalDFN">AC1</a> – <a href="#dfn-ac6" class="internalDFN">AC6</a>).
      </p></div>
      <dl> 
	<dt><dfn id="dfn-ac1">AC1</dfn></dt>
   	<dd>Attacks not focused on the users' devices and 
	  which lead to violations of FIDO security goals. (e.g., compromise of a 
	  Relying Party FIDO database and successful decryption of wrapped keys within the database, 
	  phishing, MITM attacks, etc.).
	</dd>
   	<dt><dfn id="dfn-ac2">AC2</dfn></dt>
   	<dd>Scalable attacks involving the Authenticator which, once performed, lead to the 
	  ability to violate FIDO security goals on an ongoing basis without later involving 
	  the users or their devices directly (e.g., a scalable attack on FIDO Authenticators 
	  that recovers the user private keys, allowing the attacker to impersonate the users on an ongoing basis).
	</dd>
	<dt><dfn id="dfn-ac3">AC3</dfn></dt>
   	<dd>Scalable attacks which involve the user or his device for each instance where the 
	  FIDO security goals are violated (e.g., a scalable attack that requires the 
	  Authenticator for each successful impersonation).
	</dd>
	<dt><dfn id="dfn-ac4">AC4</dfn></dt>
   	<dd>Scalable attacks on sessions authenticated by the user which violate FIDO security goals.
	</dd>
	<dt><dfn id="dfn-ac5">AC5</dfn></dt>
   	<dd>Non-scalable attacks involving the Authenticator which, once performed, lead to the ability 
	  to violate FIDO security goals on
 	  an ongoing basis without later involving the users or their devices directly (e.g., a 
	  non-scalable attack on FIDO Authenticators that recovers the user private keys, 
	  allowing the attacker to impersonate the users on an ongoing basis).
	</dd>
	<dt><dfn id="dfn-ac6">AC6</dfn></dt>
   	<dd>Non-scalable attacks which involve the user or his device for each instance 
	  where the FIDO security goals are violated (e.g., a 		
	  non-scalable attack that requires the Authenticator for each successful impersonation).
      </dd></dl>

      <div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_3"><span>Note</span></div><p class="">
	At this time we are not explicitly addressing classes of physical attacks on the authenticator that may
	lead to reduced security if the legitimate user uses the authenticator <i>after</i> the attacker having 
	physical access to it.
      </p></div>

    </section>

    <section id="fido-security-goals">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_fido-security-goals"><span class="secno">4. </span>FIDO Security Goals</h2>
      In this section the specific security goals of FIDO are described.
      The FIDO UAF protocol [<cite><a class="bibref" href="#bib-UAFProtocol">UAFProtocol</a></cite>] and U2F protocol [<cite><a class="bibref" href="#bib-U2FOverview">U2FOverview</a></cite>] support a variety of different 
      FIDO Authenticators. Even though the
      security of those authenticators varies, the UAF protocol and the FIDO Server should
      provide a very high level of security - at least on a conceptual level. In reality it might require
      a FIDO Authenticator with a high security level in order to fully leverage the FIDO
      security strength.
      <div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_4"><span>Note</span></div><p class="">In certain environments the overall security of the 
	explicit authentication (as provided by FIDO) is less important, as it
	might be supplemented with a high degree of implicit authentication or 
	the application doesn’t even require a high
	level of authentication strength.
      </p></div>

      <p>
	The FIDO U2F protocol [<cite><a class="bibref" href="#bib-U2FOverview">U2FOverview</a></cite>] supports a more constrained set of Authenticator capabilities. It
	shares the same security goals as UAF, with the exception of [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>] Transaction Non-
	Repudiation.
      </p>

      The FIDO protocols have the following security goals:
      <dl> 
	<dt>[<dfn id="dfn-sg-1">SG-1</dfn>]</dt>
	<dd> Strong User Authentication: Authenticate (i.e. recognize) a user and/or a device
	  to a relying party with high (cryptographic) strength.</dd>
	<dt>[<dfn id="dfn-sg-2">SG-2</dfn>]</dt>
	<dd>   Credential Guessing Resilience: Provide robust protection against eavesdroppers,
	  e.g. <i>be resilient to physical observation, resilient to targeted impersonation, resilient
	    to throttled and unthrottled guessing.</i>
	</dd>
	<dt>[<dfn id="dfn-sg-3">SG-3</dfn>]</dt>
	<dd>Credential Disclosure Resilience: Be <i>resilient to phishing attacks</i> and real-time
	  phishing attack, including resilience to online attacks by adversaries able to actively manipulate
	  network traffic.
	</dd>
	<dt>[<dfn id="dfn-sg-4">SG-4</dfn>]</dt>
	<dd>Unlinkablity: Protect the protocol conversation such that any two relying parties
	  cannot link the conversation to one user (i.e. be <i>unlinkable</i>).
	</dd>
	<dt>[<dfn id="dfn-sg-5">SG-5</dfn>]</dt>
	<dd> Verifier Leak Resilience: Be <i>resilient to leaks from other relying parties</i>. I.e.,
	  nothing that a verifier could possibly leak can help an attacker impersonate the user to
	  another relying party.
	</dd>
	<dt>[<dfn id="dfn-sg-6">SG-6</dfn>]</dt>
	<dd>Authenticator Leak Resilience: Be resilient to leaks from other FIDO Authenticators.
	  I.e., nothing that a particular FIDO Authenticator could possibly leak can help an
	  attacker to impersonate any other user to any relying party.
	</dd>
	<dt>[<dfn id="dfn-sg-7">SG-7</dfn>]</dt>
	<dd>User Consent: Notify the user before a relationship to a new relying party is being
	  established (<i>requiring explicit consent</i>).
	</dd>
	<dt>[<dfn id="dfn-sg-8">SG-8</dfn>]</dt>
	<dd>Limited PII: Limit the amount of personal identifiable information (PII) exposed
	  to the relying party to the absolute minimum.
	</dd>
	<dt>[<dfn id="dfn-sg-9">SG-9</dfn>]</dt>
	<dd>Attestable Properties: Relying Party must be able to verify FIDO Authenticator
	  model/type (in order to calculate the associated risk).
	</dd>
	<dt>[<dfn id="dfn-sg-10">SG-10</dfn>]</dt>
	<dd>DoS Resistance: Be resilient to <i>Denial of Service Attacks</i>. I.e. prevent attackers
	  from inserting invalid registration information for a legitimate user for the next login
	  phase. Afterward, the legitimate user will not be able to login successfully anymore.
	</dd>
	<dt>[<dfn id="dfn-sg-11">SG-11</dfn>]</dt>
	<dd>Forgery Resistance: Be resilient to <i>Forgery Attacks (Impersonation Attacks)</i>.
	  I.e. prevent attackers from attempting to modify intercepted communications in order to
	  masquerade as the legitimate user and login to the system.
	</dd>
	<dt>[<dfn id="dfn-sg-12">SG-12</dfn>]</dt>
	<dd>Parallel Session Resistance: Be resilient to <i>Parallel Session Attacks</i>. Without
	  knowing a user’s authentication credential, an attacker can masquerade as the legitimate
	  user by creating a valid authentication message out of some eavesdropped communication
	  between the user and the server.
	</dd>
	<dt>[<dfn id="dfn-sg-13">SG-13</dfn>]</dt>
	<dd>Forwarding Resistance: Be resilient to <i>Forwarding and Replay Attacks</i>. Having
	  intercepted previous communications, an attacker can impersonate the legal user to
	  authenticate to the system. The attacker can replay or forward the intercepted messages.
	</dd>
	<dt>[<dfn id="dfn-sg-14">SG-14</dfn>] (not covered by U2F)</dt>
	<dd>Transaction Non-Repudiation: Provide strong cryptographic non-repudiation
	  for secure transactions.
	</dd>
	<dt>[<dfn id="dfn-sg-15">SG-15</dfn>]</dt>
	<dd>Respect for Operating Environment Security Boundaries: Ensure that registrations
	  and private key material as a shared system resource is appropriately protected according
	  to the operating environment privilege boundaries in place on the FIDO user device.
	</dd>
	<dt>[<dfn id="dfn-sg-16">SG-16</dfn>]</dt>
	<dd>Assessable Level of Security: Ensure that the design and implementation of the Authenticator 
	  allows for the testing laboratory / <abbr title="FIDO Alliance">FIDO Alliance</abbr> to assess the level of security provided by the Authenticator.
	</dd>
      </dl>

      <div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_5"><span>Note</span></div><p class="">For a definition of the phrases printed in <i>italics</i>, 
	refer to [<cite><a class="bibref" href="#bib-QuestToReplacePasswords">QuestToReplacePasswords</a></cite>] and to [<cite><a class="bibref" href="#bib-PasswordAuthSchemesKeyIssues">PasswordAuthSchemesKeyIssues</a></cite>]</p></div>

      <section id="assets-to-be-protected">
	<h3 aria-level="2" role="heading" id="h3_assets-to-be-protected"><span class="secno">4.1 </span>Assets to be Protected</h3>
	Independent of any particular implementation, the FIDO protocols assume some assets
	to be present and to be protected.
	<ol>
	  <li>Cryptographic Authentication Private Key. Typically, private keys in FIDO are unique for each tuple
	    of (relying party, user account, authenticator).</li>
	  <li>Cryptographic Authentication Key Reference. This is the cryptographic material
	    stored at the relying party and used to uniquely verify the Cryptographic Authentication
	    Key, typically the public key corresponding to the authentication private key.</li>
	  <li>Authenticator Attestation Key (as stored in each authenticator). This should only
	    be usable to attest a Cryptographic Authentication Key and the type/model and manufacturing
	    batch of an Authenticator. Attestation keys are either ECDAA keys [<cite><a class="bibref" href="#bib-FIDOEcdaaAlgorithm">FIDOEcdaaAlgorithm</a></cite>] or the attestation keys 
	    and certificates are shared by a large number of authenticators in a device class from a given vendor in order
	    to prevent their becoming a linkable identifier across relying parties. Authenticator 
	    attestation certificates may be self-signed, or signed by an authority key
	    controlled by the vendor.</li>
	  <li>Authenticator Attestation Authority Key. An authenticator vendor may elect to
	    sign authenticator attestation certificates with a per-vendor certificate authority
	    key.</li>
	  <li>Authenticator Attestation Authority Certificate. Contained in the initial/default trust
	    store as part of the FIDO Server and contained in the active trust store maintained
	    by each relying party.</li>
	  <li>Active Trust Store. Contains all trusted attestation root certificates for a given
	    FIDO server.</li>
	  <li>All data items suitable for uniquely identifying the authenticator across relying
	    parties. An attack on those would break the non-linkability security goal.</li>
	  <li>Private key of Relying Party TLS server certificate.</li>
	  <li>TLS root certificate trust store for the users' browser/app.</li>
	</ol>
      </section>

    </section>

    <section id="fido-security-measures">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_fido-security-measures"><span class="secno">5. </span>FIDO Security Measures</h2>
      <div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_6"><span>Note</span></div><p class="">Particular implementations of FIDO Clients, Authenticators, Servers and participating
	applications may not implement all of these security measures (e.g. Secure Display,
	[<a href="#dfn-sm-10" class="internalDFN">SM-10</a>] Transaction Confirmation) and they also might (and should) implement
	add itional security measures.</p></div>
      <div class="note"><div class="note-title" aria-level="2" role="heading" id="h_note_7"><span>Note</span></div><p class="">The U2F protocol lacks support for [<a href="#dfn-sm-5" class="internalDFN">SM-5</a>] Secure Display, [<a href="#dfn-sm-10" class="internalDFN">SM-10</a>] Transaction Confirmation,
	has only server-supplied [<a href="#dfn-sm-8" class="internalDFN">SM-8</a>] Protocol Nonces, and [<a href="#dfn-sm-3" class="internalDFN">SM-3</a>] Authenticator
	Class Attestation is implicit as there is only a single class of device.</p></div>
      <dl>
	<dt>[<dfn id="dfn-sm-1">SM-1</dfn>] (U2F + UAF)</dt>
	<dd> Key Protection: Authentication key is protected against misuse. Misuse means any use violating 
	  the FIDO specification or the details given in the Metadata Statement.  
	  Before a key can be used, it requires the User to unlock it using the
	  user verification method specified in the Authenticator Metadata Statement (Silent 
	  Authenticators do not require any user verification method).
	</dd>
	<dt>[<dfn id="dfn-sm-2">SM-2</dfn>] (U2F + UAF)</dt>
	<dd> Unique Authentication Keys: Cryptographic authentication key is specific and
	  unique to the tuple of (FIDO Authenticator, User, Relying Party).
	</dd>
	<dt>[<dfn id="dfn-sm-3">SM-3</dfn>] (U2F + UAF)</dt>
	<dd> Authenticator Class Attestation: Hardware-based FIDO Authenticators support
	  authenticator attestation using an attestation key using one of the FIDO 
	  specified attestation types and algorithms. Each relying party
	  receives regular updates of the trust store (through the FIDO Metadata service).
	</dd>
	<dt>[<dfn id="dfn-sm-4">SM-4</dfn>] (UAF)</dt>
	<dd> Authenticator Status Checking: Relying Parties can download latest known status of authenticators 
	  included in the FIDO Metadata Service.  The FIDO Server should take this
	  information into account. Authenticator manufacturers should notify the <abbr title="FIDO Alliance">FIDO Alliance</abbr>
	  about compromised authenticators.  In the case of FIDO certified authenticators, such
	  notification might even be mandatory.
	</dd>
	<dt>[<dfn id="dfn-sm-5">SM-5</dfn>] (UAF)</dt>
	<dd> User Consent: FIDO Client implements a user interface for getting user’s consent
	  on any actions (except authentication with silent authenticator) and displaying RP
	  name (derived from server URL).
	</dd>
	<dt>[<dfn id="dfn-sm-6">SM-6</dfn>] (U2F + UAF)</dt>
	<dd> Cryptographically Secure Verifier Database: The relying party stores only the
	  public portion of an asymmetric key pair, or an encrypted key handle, as a cryptographic
	  authentication key reference.
	</dd>
	<dt>[<dfn id="dfn-sm-7">SM-7</dfn>] (U2F + UAF)</dt>
	<dd> Secure Channel with Server Authentication: The TLS protocol with server authentication
	  or a transport with equivalent properties is used as transport protocol for
	  UAF. The use of https is enforced by a browser or Relying Party application.
	</dd>
	<dt>[<dfn id="dfn-sm-8">SM-8</dfn>] (UAF)</dt>
	<dd> Protocol Nonces: Both server and client supplied nonces are used for UAF registration
	  and authentication. U2F requires server supplied nonces.
	</dd>
	<dt>[<dfn id="dfn-sm-9">SM-9</dfn>] (U2F + UAF)</dt>
	<dd> Authenticator Certification: The FIDO Metadata Service includes the Authenticator
	  certification status.
	</dd>
	<dt>[<dfn id="dfn-sm-10">SM-10</dfn>] (UAF)</dt>
	<dd> Transaction Confirmation (WYSIWYS): Secure Display (WYSIWYS) (optionally)
	  implemented by the FIDO Authenticators is used by FIDO Client for displaying relying
	  party name and transaction data to be confirmed by the user.
	</dd>
	<dt>[<dfn id="dfn-sm-11">SM-11</dfn>] (U2F + UAF)</dt>
	<dd> Round Trip Integrity: FIDO server verifies that the transaction data related to
	  the server challenge received in the UAF message from the FIDO client is identical to
	  the transaction data and server challenge delivered as part of the UAF request message.
	</dd>
	<dt>[<dfn id="dfn-sm-12">SM-12</dfn>] (U2F + UAF)</dt>
	<dd> Channel Binding: Relying Party servers may verify the continuity of a secure
	  channel with a client application.
	</dd>
	<dt>[<dfn id="dfn-sm-13">SM-13</dfn>] (UAF)</dt>
	<dd> Key Handle Access Token: Authenticators not intended to roam between untrusted
	  systems are able to constrain the use of registration keys within the privilege
	  boundaries defined by the operating environment of the user device (per-user, or per application,
	  or per-user + per-application as appropriate).
	</dd>
	<dt>[<dfn id="dfn-sm-14">SM-14</dfn>] (U2F + UAF)</dt>
	<dd> AppID Separation: A Relying Party can declare the application identities allowed
	  to access its registered keys, for operating environments on user devices that
	  support this concept.
	</dd>
	<dt>[<dfn id="dfn-sm-15">SM-15</dfn>] (U2F + UAF)</dt>
	<dd> Signature Counter: Authenticators send a monotonically increasing signature counter
	  that a Relying Party can check to possibly detect cloned authenticators.
	</dd>
	<dt>[<dfn id="dfn-sm-16">SM-16</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Use of strong, modern Cryptographic Primitives: The FIDO specifications stipulate 
	  the use of strong, modern cryptographic primitives helping to ensure the overall 
	  security of conformant FIDO implementations.  The FIDO Authenticator certification program 
	  defines the "Allowed Cryptography List" for allowed cryptographic primitives to be used in 
	  FIDO certified authenticators.
	</dd>
	<dt>[<dfn id="dfn-sm-17">SM-17</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Resistance to Side Channel Attacks.
	</dd>
	<dt>[<dfn id="dfn-sm-18">SM-18</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Resistance to Injected Faults in Cryptographic Functions. This security measure purely deals with the cryptographic
 	  functions, as compared to the much more general [<a href="#dfn-sm-28" class="internalDFN">SM-28</a>].
	</dd>
	<dt>[<dfn id="dfn-sm-19">SM-19</dfn>] (UAF)</dt>
	<dd> 
	  Bounded Probability of a Birthday Collision. For randomly generated nonces, the total number of nonces 
	  that can be generated is limited to bound the probability of a birthday collision of generated values.
	</dd>
	<dt>[<dfn id="dfn-sm-20">SM-20</dfn>] (U2F + UAF)</dt>
	<dd>
	  Individual authenticators are indistinguishable provided authenticators sharing attestation keys
	  are manufactured in sufficiently large (e.g. &gt; 100000) per-model batches.
	</dd>
	<dt>[<dfn id="dfn-sm-21">SM-21</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Authentication and replay-resistance (freshness assurance) of externally-stored protected information.
	</dd>
	<dt>[<dfn id="dfn-sm-22">SM-22</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Certified FIDO Authenticators fully described by the vendor, and tested to verify that it functions as specified.
	</dd>
	<dt>[<dfn id="dfn-sm-23">SM-23</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Key Handles containing a key are cryptographically linked with the Authenticator that produced the 
	  Key Handle and with the Relying Party associated with the Key Handle.
	</dd>
	<dt>[<dfn id="dfn-sm-24">SM-24</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Design, implementation and manufacture of certified FIDO Authenticators supports Authenticator security.
	</dd>
	<dt>[<dfn id="dfn-sm-25">SM-25</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Depending on the certification level, certified authenticators are required to implement a 
	  Trusted Path for all user / Authenticator direct interactions.
	</dd>
	<dt>[<dfn id="dfn-sm-26">SM-26</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Input Data Validation: Malformed or maliciously crafted input data does not result in unexpected Authenticator behavior.
	</dd>
	<dt>[<dfn id="dfn-sm-27">SM-27</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Protection of user verification reference data and biometric data.
	</dd>
	<dt>[<dfn id="dfn-sm-28">SM-28</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Resistance to Fault Injection Attacks.
	</dd>
	<dt>[<dfn id="dfn-sm-29">SM-29</dfn>] (U2F + UAF)</dt>
	<dd> 
	  Resistance to Remote Timing Attacks: No leakage of secret information to remote entities via variation of operation
 	  execution time.
	</dd>
      </dl>
      <section id="relation-between-measures-and-goals">
	<h3 aria-level="2" role="heading" id="h3_relation-between-measures-and-goals"><span class="secno">5.1 </span>Relation between Measures and Goals</h3>

	<table class="threats">
	  <thead>
	    <tr><th>Security Goal</th><th>Supporting Security Measures</th></tr>
	  </thead>
	  <tbody>
	    <tr>
	      <td>[<a href="#dfn-sg-1" class="internalDFN">SG-1</a>] Strong User Authentication</td>
	      <td><p>[<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection</p>
		<p>[<a href="#dfn-sm-12" class="internalDFN">SM-12</a>] Channel Binding</p>
		<p>[<a href="#dfn-sm-14" class="internalDFN">SM-14</a>] AppID Separation</p>
		<p>[<a href="#dfn-sm-15" class="internalDFN">SM-15</a>] Signature Counter</p>
		<p>[<a href="#dfn-sm-16" class="internalDFN">SM-16</a>] Allowed Crypto Primitives</p>
		<p>[<a href="#dfn-sm-17" class="internalDFN">SM-17</a>] Resistance to Side Channel Attacks</p>
		<p>[<a href="#dfn-sm-21" class="internalDFN">SM-21</a>] Authentication and replay-resistance</p>
		<p>[<a href="#dfn-sm-23" class="internalDFN">SM-23</a>] Key Handles cryptographically linked with the Authenticator</p>
		<p>[<a href="#dfn-sm-25" class="internalDFN">SM-25</a>] Trusted path for all user interactions</p>
		<p>[<a href="#dfn-sm-29" class="internalDFN">SM-29</a>] Resistance to Remote Timing Attacks</p>
	      </td>
	    </tr><tr>
	      <td>[<a href="#dfn-sg-2" class="internalDFN">SG-2</a>] Credential Guessing Resilience</td>
	      <td><p>[<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection</p>
		<p>[<a href="#dfn-sm-6" class="internalDFN">SM-6</a>] Cryptographically Secure Verifier Database</p>
		<p>[<a href="#dfn-sm-16" class="internalDFN">SM-16</a>] Allowed Crypto Primitives</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-3" class="internalDFN">SG-3</a>] Credential Disclosure Resilience</td>
	      <td><p>[<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection</p>
		<p>[<a href="#dfn-sm-9" class="internalDFN">SM-9</a>] Authenticator Certification</p>
		<p>[<a href="#dfn-sm-15" class="internalDFN">SM-15</a>] Signature Counter</p>
		<p>[<a href="#dfn-sm-17" class="internalDFN">SM-17</a>] Resistance to Side Channel Attacks</p>
		<p>[<a href="#dfn-sm-29" class="internalDFN">SM-29</a>] Resistance to Remote Timing Attacks</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-4" class="internalDFN">SG-4</a>] Unlinkability</td>
	      <td><p>[<a href="#dfn-sm-2" class="internalDFN">SM-2</a>] Unique Authentication Keys</p>
		<p>[<a href="#dfn-sm-3" class="internalDFN">SM-3</a>] Authenticator Class Attestation</p>
		<p>[<a href="#dfn-sm-20" class="internalDFN">SM-20</a>] No Identifying Information</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-5" class="internalDFN">SG-5</a>] Verifier Leak Resilience</td>
	      <td><p>[<a href="#dfn-sm-2" class="internalDFN">SM-2</a>] Unique Authentication Keys</p>
  		<p>[<a href="#dfn-sm-6" class="internalDFN">SM-6</a>] Cryptographically Secure Verifier Database</p>
		<p>[<a href="#dfn-sm-16" class="internalDFN">SM-16</a>] Allowed Crypto Primitives</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-6" class="internalDFN">SG-6</a>] Authenticator Leak Resilience</td>
	      <td><p>[<a href="#dfn-sm-9" class="internalDFN">SM-9</a>] Authenticator Certification</p>
		<p>[<a href="#dfn-sm-15" class="internalDFN">SM-15</a>] Signature Counter</p>
		<p>[<a href="#dfn-sm-16" class="internalDFN">SM-16</a>] Allowed Crypto Primitives</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-7" class="internalDFN">SG-7</a>] User Consent</td>
	      <td><p>[<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection</p>
		<p>[<a href="#dfn-sm-5" class="internalDFN">SM-5</a>] User Consent</p>
		<p>[<a href="#dfn-sm-7" class="internalDFN">SM-7</a>] Secure Channel with Server Authentication</p>
		<p>[<a href="#dfn-sm-10" class="internalDFN">SM-10</a>] Transaction Confirmation (WYSIWYS)</p>
		<p>[<a href="#dfn-sm-25" class="internalDFN">SM-25</a>] Trusted path for all user interactions</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-8" class="internalDFN">SG-8</a>] Limited PII</td>
	      <td><p>[<a href="#dfn-sm-2" class="internalDFN">SM-2</a>] Unique Authentication Keys</p>
		<p>[<a href="#dfn-sm-20" class="internalDFN">SM-20</a>] No Identifying Information</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-9" class="internalDFN">SG-9</a>] Attestable Properties</td>
	      <td><p>[<a href="#dfn-sm-3" class="internalDFN">SM-3</a>] Authenticator Class Attestation</p>
 		<p>[<a href="#dfn-sm-4" class="internalDFN">SM-4</a>] Authenticator Status Checking</p>
		<p>[<a href="#dfn-sm-9" class="internalDFN">SM-9</a>] Authenticator Certification</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-10" class="internalDFN">SG-10</a>] DoS Resistance</td>
	      <td><p>[<a href="#dfn-sm-8" class="internalDFN">SM-8</a>] Protocol Nonces</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-11" class="internalDFN">SG-11</a>] Forgery Resistance</td>
	      <td><p>[<a href="#dfn-sm-7" class="internalDFN">SM-7</a>] Secure Channel with Server Authentication</p>
		<p>[<a href="#dfn-sm-8" class="internalDFN">SM-8</a>] Protocol Nonces</p>
		<p>[<a href="#dfn-sm-11" class="internalDFN">SM-11</a>] Round Trip Integrity</p>
		<p>[<a href="#dfn-sm-12" class="internalDFN">SM-12</a>] Channel Binding</p>
		<p>[<a href="#dfn-sm-17" class="internalDFN">SM-17</a>] Resistance to Side Channel Attacks</p>
		<p>[<a href="#dfn-sm-23" class="internalDFN">SM-23</a>] Key Handles cryptographically linked with the Authenticator</p>
		<p>[<a href="#dfn-sm-29" class="internalDFN">SM-29</a>] Resistance to Remote Timing Attacks</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-12" class="internalDFN">SG-12</a>] Parallel Session Resistance</td>
	      <td><p>[<a href="#dfn-sm-7" class="internalDFN">SM-7</a>] Secure Channel with Server Authentication</p>
		<p>[<a href="#dfn-sm-8" class="internalDFN">SM-8</a>] Protocol Nonces</p>
		<p>[<a href="#dfn-sm-11" class="internalDFN">SM-11</a>] Round Trip Integrity</p>
		<p>[<a href="#dfn-sm-12" class="internalDFN">SM-12</a>] Channel Binding</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-13" class="internalDFN">SG-13</a>] Forwarding Resistance</td>
	      <td><p>[<a href="#dfn-sm-7" class="internalDFN">SM-7</a>] Secure Channel with Server Authentication</p>
		<p>[<a href="#dfn-sm-8" class="internalDFN">SM-8</a>] Protocol Nonces</p>
		<p>[<a href="#dfn-sm-11" class="internalDFN">SM-11</a>] Round Trip Integrity</p>
		<p>[<a href="#dfn-sm-12" class="internalDFN">SM-12</a>] Channel Binding</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[<a href="#dfn-sg-14" class="internalDFN">SG-14</a>] Transaction Non-Repudiation</td>
	      <td><p>[<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection</p>
  		<p>[<a href="#dfn-sm-2" class="internalDFN">SM-2</a>] Unique Authentication Keys</p>
		<p>[<a href="#dfn-sm-8" class="internalDFN">SM-8</a>] Protocol Nonces</p>
		<p>[<a href="#dfn-sm-9" class="internalDFN">SM-9</a>] Authenticator Certification</p>
		<p>[<a href="#dfn-sm-10" class="internalDFN">SM-10</a>] Transaction Confirmation (WYSIWYS)</p>
		<p>[<a href="#dfn-sm-11" class="internalDFN">SM-11</a>] Round Trip Integrity</p>
		<p>[<a href="#dfn-sm-12" class="internalDFN">SM-12</a>] Channel Binding</p>
		<p>[<a href="#dfn-sm-25" class="internalDFN">SM-25</a>] Trusted path for all user interactions</p>
	      </td>
	    </tr>
	    <tr>
	      <td>[SG-15] Respect for Operating Environment Security Boundaries</td>
	      <td><p>[<a href="#dfn-sm-13" class="internalDFN">SM-13</a>] Key Handle Access Token</p>
		<p>[<a href="#dfn-sm-14" class="internalDFN">SM-14</a>] AppID Separation</p>
	      </td>
	    </tr>
	  </tbody>
	</table>


      </section>

    </section>

    <section id="fido-security-assumptions">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_fido-security-assumptions"><span class="secno">6. </span>FIDO Security Assumptions</h2>
      In this section, we enumerate the assumptions we are making regarding the security characteristics 
      of the operating environment components on which a FIDO implementation depends.

      <dl>
	<dt>[<dfn id="dfn-sa-1">SA-1</dfn>]</dt>
	<dd>The Authenticator and its cryptographic algorithms and parameters (key size, mode, output length,
	  etc.) in use are not subject to unknown weaknesses that make them unfit for their purpose
	  in encrypting, digitally signing, and authenticating messages.
	</dd>
	<dt>[<dfn id="dfn-sa-2">SA-2</dfn>]</dt>
	<dd>Operating system privilege separation mechanisms relied up on by the software
	  modules involved in a FIDO operation on the user device perform as advertised. E.g.
	  boundaries between user and kernel mode, between user accounts, and between applications
	  (where applicable) are securely enforced and security principals can be mutually,
	  securely identifiable.
	</dd>
	<dt>[<dfn id="dfn-sa-3">SA-3</dfn>]</dt>
	<dd>Applications on the user device are able to establish secure channels that provide
	  trustworthy server authentication, and confidentiality and integrity for messages
	  (e.g., through TLS).
	</dd>
	<dt>[<dfn id="dfn-sa-4">SA-4</dfn>]</dt>
	<dd> The computing environment on the FIDO user device and the and applications
	  involved in a FIDO operation act as trustworthy agents of the user.
	</dd>
	<dt>[<dfn id="dfn-sa-5">SA-5</dfn>]</dt>
	<dd> The inherent value of a cryptographic key resides in the confidence it imparts,
	  and this commodity decays with the passage of time, irrespective of any compromise
	  event. As a result the effective assurance level of authenticators will be reduced over
	  time.
	</dd>
	<dt>[<dfn id="dfn-sa-6">SA-6</dfn>]</dt>
	<dd>The computing resources at the Relying Party involved in processing a FIDO operation
	  act as trustworthy agents of the Relying Party.
	</dd>
      </dl>

      <section id="discussion">
	<h3 aria-level="2" role="heading" id="h3_discussion"><span class="secno">6.1 </span>Discussion</h3>
	With regard to [<a href="#dfn-sa-4" class="internalDFN">SA-4</a>] and malicious computation on the FIDO user device, only very
	limited guarantees can be made within the scope of these assumptions. Malicious code
	privileged at the level of the trusted computing base can always violate [<a href="#dfn-sa-2" class="internalDFN">SA-2</a>] and [SA-
	3]. Malicious code privileged at the level of the users' account in traditional multi-user
	environments will also likely be able to violate [<a href="#dfn-sa-3" class="internalDFN">SA-3</a>].

	<p>FIDO can also provide only limited protections when a user chooses to deliberately violate
	  [<a href="#dfn-sa-4" class="internalDFN">SA-4</a>], e.g. by roaming a USB authenticator to an untrusted system like a kiosk, or
	  by granting permissions to access all authentication keys to a malicious app in a mobile
	  environment.  Transaction Confirmation can be used as a method to protect against compromised 
	  FIDO user devices.</p>

	<p>In to components such as the FIDO Client, Server, Authenticators and the mix of software
	  and hardware modules they are comprised of, the end-to-end security goals also
	  depend on correct implementation and adherence to FIDO security guidance by other
	  participating components, including web browsers and relying party applications. Some
	  configurations and uses may not be able to meet all security goals. For example, authenticators
	  may lack a secure display, they may be composed only of unattestable software
	  components, they may be deliberately designed to roam between untrusted operating
	  environments, and some operating environments may not provide all necessary
	  security primitives (e.g., secure IPC, application isolation, modern TLS implementations,
	  etc.)</p>
      </section>

    </section>

    <section id="threat-analysis">
      <!--OddPage--><h2 aria-level="1" role="heading" id="h2_threat-analysis"><span class="secno">7. </span>Threat Analysis</h2>
      In the following tables describing threats, we mention the relevant attack class(es) in the left column
      if the threat might lead to user impersonation.

      <section id="threats-to-client-side">
	<h3 aria-level="2" role="heading" id="h3_threats-to-client-side"><span class="secno">7.1 </span>Threats to Client Side</h3>

	<section id="exploiting-user-s-pattern-matching-weaknesses">
	  <h4 aria-level="3" role="heading" id="h4_exploiting-user-s-pattern-matching-weaknesses"><span class="secno">7.1.1 </span>Exploiting User’s pattern matching weaknesses</h4>

	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.1.1</th><th>Homograph Mis-Registration</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		<td>The user registers a FIDO authentication key with a fraudulent
		  web site instead of the genuine Relying Party.
		  <p><b>Consequences:</b>
		    The fraudulent site may convince the user to disclose a set of non-FIDO credentials
		    sufficient to allow the attacker to register a FIDO Authenticator under its own
		    control, at the genuine Relying Party, on the users' behalf, violating [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>]
		    Strong User Authentication.</p>
		  <p><b>Mitigations:</b>
		    Disclosure of non-FIDO credentials is outside of the scope of the FIDO security
		    measures, but Relying Parties should be aware that the initial strength of an authentication
		    key is no better than the identity-proofing applied as part of the registration
		    process.</p></td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.1.2</th><th>Homograph Mis-Authentication</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		<td>The user accidentally browses to a fraudulent web site.  The attacker tries 
		  to act as man-in-the-middle (MITM) and requests the user to authenticate.
		  In the case of username/password based authentication this is a typical phishing attack.
		  <p><b>Consequences:</b>
		    The FIDO subsystem will determine that either (a) no FIDO authenticator has been 
		    registered with the fraudulent site or (b)
		    it will use the FIDO Uauth key registered to the fraudulent site - 
		    which is different from the Uauth key for the relying party's site.
		  </p><p><b>Mitigations:</b>
		    FIDO inherently ties keys to the relying party (formally identified by the AppID, 
		    and authenticated by TLS and the CA infrastructure).
		  </p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a></td>
	      </tr>
	    </tbody>
	  </table>
	</section>

	<section id="threats-to-the-user-device-fido-client-and-relying-party-client-applications">
	  <h4 aria-level="3" role="heading" id="h4_threats-to-the-user-device-fido-client-and-relying-party-client-applications"><span class="secno">7.1.2 </span>Threats to the User Device, FIDO Client and Relying Party Client Applications</h4>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.2.1</th><th>FIDO Client Corrpution</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		<td>Attacker gains ability to execute code in the security context of the FIDO Client.
		  <p><b>Consequences:</b> Violation of [<a href="#dfn-sa-4" class="internalDFN">SA-4</a>].</p>
		  <p><b>Mitigations:</b> When the operating environment on the FIDO user device allows, the FIDO
		    Client should operate in a privileged and isolated context under [<a href="#dfn-sa-2" class="internalDFN">SA-2</a>] to protect
		    itself from malicious modification by anything outside of the Trusted Computing
		    Base.</p>
		</td>
		<td><a href="#dfn-sa-4" class="internalDFN">SA-4</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.2.2</th><th>Logical/Physical User Device Attack</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a> / <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td>Attacker gains physical access to the FIDO user device but not the FIDO Authenticator.

		  <p><b>Consequences:</b> Possible violation of [<a href="#dfn-sa-4" class="internalDFN">SA-4</a>] by installing malicious 
		    software or otherwise tampering with the FIDO user device.</p>
		  <p><b>Mitigations:</b> [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection prevents the disclosure of authentication keys or other
		    assets during a transient compromise of the FIDO user device.</p>
		  <p>A persistent compromise of the FIDO user device can lead to a violation of [<a href="#dfn-sa-4" class="internalDFN">SA-4</a>]
		    unless additional protection measures outside the scope of FIDO are applied to
		    the FIDO user device. (e.g. whole disk encryption and boot-chain integrity).</p>
		</td>
		<td><a href="#dfn-sa-4" class="internalDFN">SA-4</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.2.3</th><th>User Device Account Access</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a> / <a href="#dfn-ac4" class="internalDFN">AC4</a></td>
		<td>Attacker gains access to a user's login credentials on the FIDO user device.
		  <p><b>Consequences:</b> Authenticators might be remotely abused, or weakly-verifying 
		    authenticators might be locally abused, violating [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>] Strong User Authentication and
		    [<a href="#dfn-sg-13" class="internalDFN">SG-13</a>] Transaction Non-Repudiation.</p>
		  <p>Possible violation of [<a href="#dfn-sa-4" class="internalDFN">SA-4</a>] by the installation of malicious software.</p>
		  <p><b>Mitigations:</b> Relying Parties can use [<a href="#dfn-sm-9" class="internalDFN">SM-9</a>] Authenticator Certification 
		    and [<a href="#dfn-sm-3" class="internalDFN">SM-3</a>] Authenticator Class Attestation to determine the nature 
		    of authenticators and not rely on weak, or weakly-verifying authenticators 
		    for high value operations.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-13" class="internalDFN">SG-13</a>; <a href="#dfn-sa-4" class="internalDFN">SA-4</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th><dfn id="dfn-t-1.2.4">T-1.2.4</dfn></th><th>App Server Verification Error</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		<td>A client application fails to properly validate the remote sever identity, accepts
		  forged or stolen credentials for a remote server, or allows weak or missing cryptographic
		  protections for the secure channel.
		  <p><b>Consequences:</b> An active network adversary can modify the Relying Party's authenticator policy
		    and downgrade the client's choice of authenticator to make it easier to attack.</p>
		  <p>An active network adversary can intercept or view FIDO messages intended for
		    the Relying Party. It may be able to use this ability to violate [<a href="#dfn-sg-12" class="internalDFN">SG-12</a>] Parallel
		    Session Resistance, [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>] Forgery Resistance or [<a href="#dfn-sg-13" class="internalDFN">SG-13</a>] Forwarding Resistance.</p>
		  <p><b>Mitigations:</b> The server can verify [<a href="#dfn-sm-8" class="internalDFN">SM-8</a>] Protocol Nonces to detect replayed messages and
		    protect from an adversary that can read but not modify traffic in a secure channel.</p>
		  <p>The server can mandate a channel with strong cryptographic protections to prevent
		    message forgery and can verify a [<a href="#dfn-sm-12" class="internalDFN">SM-12</a>] Channel Binding to detect forwarded
		    messages.</p>
		</td>
		<td><a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-12" class="internalDFN">SG-12</a>, <a href="#dfn-sg-13" class="internalDFN">SG-13</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th><dfn id="dfn-t-1.2.5">T-1.2.5</dfn></th><th>RP App Corruption</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td></td>
		<td>An attacker is able to obtain malicious execution in the security context of the Relying
		  Party client application (e.g. via Cross-Site Scripting (XSS)) or abuse the secure channel
		  or session identifier after the user has successfully authenticated.  This is a client side attack.
		  <p><b>Consequences:</b> The attacker is able to control the users' session, 
		    violating [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>] Transaction Non-Repudiation.</p>
		  <p><b>Mitigations:</b> The server can employ [<a href="#dfn-sm-10" class="internalDFN">SM-10</a>] Transaction Confirmation to gain 
		    additional assurance for high value operations.</p>
		</td>
		<td><a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.2.6</th><th>Fingerprinting Authenticators</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td></td>
		<td>A remote adversary is able to uniquely identify a FIDO user device using the fingerprint
		  of discoverable configuration of its FIDO Authenticators.
		  <p><b>Consequences:</b> The exposed information violates [<a href="#dfn-sg-8" class="internalDFN">SG-8</a>] Limited PII, 
		    allowing an adversary to violate [<a href="#dfn-sg-7" class="internalDFN">SG-7</a>] User Consent by strongly identfying 
		    the user without their knowledge and [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>] Unlinkablity by 
		    sharing that fingerprint.</p>
		  <p><b>Mitigations:</b> [<a href="#dfn-sm-3" class="internalDFN">SM-3</a>] Authenticator Class Attestation ensures that 
		    the fingerprint of an Authenticator will not be unique.</p>
		  <p>For web browsing situations where this threat is most prominent, user agents
		    may provide additional user controls around the discoverability of FIDO Authenticators.</p>
		</td>
		<td><a href="#dfn-sg-4" class="internalDFN">SG-4</a>, SG7, <a href="#dfn-sg-8" class="internalDFN">SG-8</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.2.7</th><th>App to FIDO Client full MITM attack</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		<td>Malicious software on the FIDO user device is able to read, tamper with, or spoof
		  the endpoint of inter-process communication channels between the FIDO Client
		  and browser or Relying Party application.
		  <p><b>Consequences:</b> Adversary is able to subvert [<a href="#dfn-sa-2" class="internalDFN">SA-2</a>].</p>
		  <p><b>Mitigations:</b> On platforms where [<a href="#dfn-sa-2" class="internalDFN">SA-2</a>] is not strong the security 
		    of the system may depend on preventing malicious
		    applications from being loaded onto the FIDO user device. Such protections, e.g.
		    app store policing, are outside the scope of FIDO.</p>
		  <p>When using [<a href="#dfn-sm-10" class="internalDFN">SM-10</a>] Transaction Confirmation, the user 
		    will be presented with the relevant AppID and transaction text and will
		    be able to evaluate whether or not to consent to the transaction.
		  </p>
		</td>
		<td><a href="#dfn-sa-2" class="internalDFN">SA-2</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.2.8</th><th>Authenticator to App Read-Only MITM attack</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		<td>An adversary is able to obtain an authenticator's signed protocol response message.
		  <p><b>Consequences:</b> The attacker attempts to replay the message to authenticate 
		    as the user, violating [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>] Strong User Authentication, [<a href="#dfn-sg-13" class="internalDFN">SG-13</a>] Forwarding Resistance and
		    [<a href="#dfn-sg-12" class="internalDFN">SG-12</a>] Parallel Session Resistance.</p>
		  <p><b>Mitigations:</b> The server can use [<a href="#dfn-sm-8" class="internalDFN">SM-8</a>] Protocol Nonces to detect replay of messages and
		    verify [<a href="#dfn-sm-11" class="internalDFN">SM-11</a>] Round Trip Integrity to detect modified messages.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-12" class="internalDFN">SG-12</a>, <a href="#dfn-sg-13" class="internalDFN">SG-13</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.2.9</th><th>Malicious App</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		<td>A user installs an application that represents itself as being associated with to
		  one Relying Party application but actually initiates a protocol conversation with a
		  different Relying Party and attempts to abuse previously registered authentication
		  keys at that Relying Party.
		  <p><b>Consequences:</b> Adversary is able to violate [<a href="#dfn-sg-7" class="internalDFN">SG-7</a>] User Consent by misrepresenting the target
		    of authentication.</p>
		  <p>Other consequences equivalent to [<a href="#dfn-t-1.2.5" class="internalDFN">T-1.2.5</a>]</p>
		  <p><b>Mitigations:</b> If a [<a href="#dfn-sm-5" class="internalDFN">SM-5</a>] Transaction Confirmation Display is present, the user 
		    may be able to verify the true target of an operation.</p>
		  <p>If the malicious application attempts to communicate directly with an Authenticator
		    that uses [<a href="#dfn-sm-13" class="internalDFN">SM-13</a>] KeyHandleAccessToken, it should not be able to access keys registered
		    by other FIDO Clients.</p>
		  <p>If the operating environment on the FIDO user device supports it, the FIDO client
		    may be able to determine the application's identity and verify if it is authorized to
		    target that Relying Party using a [<a href="#dfn-sm-14" class="internalDFN">SM-14</a>] AppID Separation.</p>	      
		</td>
		<td><a href="#dfn-sg-7" class="internalDFN">SG-7</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.2.10</th><th>Phishing Attack</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a></td>
		<td>A Phisher convinces the user to enter his PIN used for user verification into an application / 
		  web site disclosing the PIN to the Phisher.  In the traditional username/password world
		  this enables the attacker to successfully impersonate the user (to the relying party).
		  <p><b>Consequences:</b> None as the phisher additionally would need access to the Authenticator
		    in order to pass user verification [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>].  In FIDO, the user verification PIN (if user 
		    verification is done via PIN) is not known to the 
		    relying party and hence isn't sufficient for user impersonation.
		    If user verification is done using an alternative user verification method, this applies
		    accordingly.</p>
		  <p><b>Mitigations:</b> In FIDO, the Uauth.priv key is used to sign a relying party supplied challenge.
		    without (use) access to that key, no impersonation is possible.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>

	</section>

	<section id="creating-a-fake-client">
	  <h4 aria-level="3" role="heading" id="h4_creating-a-fake-client"><span class="secno">7.1.3 </span>Creating a Fake Client</h4>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.3.1</th><th>Malicious FIDO Client</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		<td>Attacker convinces users to install and use a malicious FIDO Client.
		  <p><b>Consequences:</b> Violation of [<a href="#dfn-sa-4" class="internalDFN">SA-4</a>]</p>
		  <p><b>Mitigations:</b> Mitigating malicious software installation is outside the scope of FIDO.</p>
		  <p>If an authenticator implements [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection, the user may be able to
		    recover full control of their registered authentication keys by removing the malicious
		    software from their user device.</p>
		  <p>When using [<a href="#dfn-sm-10" class="internalDFN">SM-10</a>] Transaction Confirmation, the user sees the real AppIDs 
		    and transaction text and can decide to accept or reject the action.</p>
		</td>
		<td><a href="#dfn-sa-4" class="internalDFN">SA-4</a></td>
	      </tr>
	    </tbody>
	  </table>
	</section>

	<section id="threats-to-fido-authenticator">
	  <h4 aria-level="3" role="heading" id="h4_threats-to-fido-authenticator"><span class="secno">7.1.4 </span>Threats to FIDO Authenticator</h4>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.1</th><th>Malicious Authenticator</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		<td>Attacker convinces users to use a maliciously implemented authenticator.
		  <p><b>Consequences:</b> The fake authenticator does not implement any appropriate 
		    security measures and is able to violate all security goals of FIDO.</p>
		  <p><b>Mitigations:</b> A user may be unable to distinguish a malicious authenticator, 
		    but a Relying Party can use [<a href="#dfn-sm-3" class="internalDFN">SM-3</a>] Authenticator Class Attestation to identify and only allow
		    registration of reliable authenticators that have passed [<a href="#dfn-sm-9" class="internalDFN">SM-9</a>] Authenticator
		    Certification.</p>
		  <p>A Relying Party can additionally rely on [<a href="#dfn-sm-4" class="internalDFN">SM-4</a>] Authenticator Status Checking
		    to check if an attestation presented by a malicious authenticator has been
		    marked as compromised.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th><dfn id="dfn-t-1.4.2">T-1.4.2</dfn></th><th>Uauth.priv Key Compromise</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a></td>
		<td>Attacker succeeds in extracting a user's cryptographic authentication private key for use in a
		  different context.
		  <p><b>Consequences:</b> The attacker could impersonate the user with a cloned authenticator that does
		    not do trustworthy user verification, violating [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>].</p>
		  <p><b>Mitigations:</b> [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection measures are intended to prevent this.</p>
		  <p>Each authentication private key is only used for one relying party.</p>
		  <p>Relying Parties can check [<a href="#dfn-sm-9" class="internalDFN">SM-9</a>] Authenticator Certification attributes to determine
		    the type of key protection in use by a given authenticator class.</p>
		  <p>Relying Parties can additionally verify the [<a href="#dfn-sm-15" class="internalDFN">SM-15</a>] Signature Counter and detect that
		    an authenticator has been cloned if it ever fails to advance relative to the prior
		    operation.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.3</th><th>User Verification By-Pass</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td>Attacker could use the cryptographic authentication key (inside the authenticator)
		  either with or without being noticed by the legitimate user.
		  <p><b>Consequences:</b> Attacker could impersonate user, violating [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>].</p>
		  <p><b>Mitigations:</b> A user can only register and a Relying Party only 
		    allow authenticators that perform [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection with an appropriately 
		    secure user verification process.</p>
		  <p>Does not apply to Silent Authenticators (see [<cite><a class="bibref" href="#bib-FIDOGlossary">FIDOGlossary</a></cite>]).</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th><dfn id="dfn-t-1.4.4">T-1.4.4</dfn></th><th>Physical Authenticator Attack</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>Attacker could get physical access to FIDO Authenticator (e.g. by stealing it).
		  <p><b>Consequences:</b> Attacker could bring the authenticator in a lab in order to use 
		    the authentication key (e.g. by-passing user verification and knowing the RP related to this key).
		    If this physical attack succeeds, the attacker could 
		    successfully impersonate the user, violating [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>] Strong User Authentication.</p>
		  <p>Attacker can introduce a low entropy situation to recover an ECDSA signature
		    key (or optherwise extract the Uauth.priv key), violating [<a href="#dfn-sg-9" class="internalDFN">SG-9</a>] Attestable Properties 
		    if the attestation key is targeted or
		    [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>] Strong User Authentication if a user key is targeted.</p>
		  <p><b>Mitigations:</b> [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection includes requirements to implement strong protections
		    for key material, including resiliance to offline attacks and low entropy situations.</p>
		  <p>Relying Parties should use [<a href="#dfn-sm-3" class="internalDFN">SM-3</a>] Authenticator Class Attestation to only 
		    accept Authenticators implementing a sufficiently strong user verification method.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th><dfn id="dfn-t-1.4.6">T-1.4.6</dfn></th><th>Fake Authenticator</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a></td>
		<td>Attacker is able to extract the authenticator attestation key from an authenticator,
		  e.g. by neutralizing physical countermeasures in a laboratory setting.
		  <p><b>Consequences:</b> Attacker can violate [<a href="#dfn-sg-9" class="internalDFN">SG-9</a>] Attestable Properties by 
		    creating a malicious hardware or software device that represents 
		    itself as a legitimate one.</p>
		  <p><b>Mitigations:</b> Relying Parties can use [<a href="#dfn-sm-4" class="internalDFN">SM-4</a>] Authenticator Status Checking to identify
		    known-compromised keys. Identification of such compromise is outside the strict
		    scope of the FIDO protocols.</p>
		</td>
		<td><a href="#dfn-sg-9" class="internalDFN">SG-9</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.7</th><th>Transaction Confirmation Display Overlay Attack</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>Attacker is able to subvert [<a href="#dfn-sm-5" class="internalDFN">SM-5</a>] Secure Display functionality (WYSIWYS), perhaps
		  by overlaying the display with false information.
		  <p><b>Consequences:</b> Violation of [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>] Transaction Non-Repudiation.</p>
		  <p><b>Mitigations:</b> Authenticator implementations must take care to protect in 
		    their implementation of a secure display, e.g. by implementing a 
		    distinct hardware display or employing appropriate
		    privileges in the operating environment of the user device to protect
		    against spoofing and tampering.</p>
		  <p>[<a href="#dfn-sm-9" class="internalDFN">SM-9</a>] Authenticator Certification will provide Relying Parties with metadata
		    about the nature of a transaction confirmation display information that can be used to assess
		    whether it matches the assurance level and risk tolerance of the Relying Party for
		    that particular transaction.</p>
		</td>
		<td><a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.8</th><th>Signature Algorithm Attack</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a>, <a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td>A cryptographic attack is discovered against the public key cryptography system
		  used to sign data by the FIDO authenticator.  See also T-1.4.10.
		  <p><b>Consequences:</b> Attacker is able to use messages generated by the 
		    client to violate [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>] Credential Guessing Resistance.</p>
		  <p><b>Mitigations:</b> [<a href="#dfn-sm-8" class="internalDFN">SM-8</a>] Protocol Nonces, including client-generated entropy, limit the amount of
		    control any adversary has over the internal structure of an authenticator.</p>
		  <p>[<a href="#dfn-sm-1" class="internalDFN">SM-1</a>] Key Protection for non-silent authenticators requires user interaction to
		    authorize any operation performed with the authentication key, severely limiting
		    the rate at which an adversary can perform adaptive cryptographic attacks.</p>	      
		</td>
		<td><a href="#dfn-sg-2" class="internalDFN">SG-2</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.9</th><th>Abuse Functionality</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>It might be possible for an attacker to abuse the Authenticator functionality by sending 
		  commands with invalid parameters or invalid commands to the Authenticator.
		  <p><b>Consequences:</b> This might lead to e.g., user verification by-pass or 
		    potential key extraction.</p>
		  <p><b>Mitigations:</b> Proper robustness (e.g. due to testing) of the Authenticator firmware.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.10</th><th>Random Number prediction</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>It might be possible for an attacker to get access to information allowing the prediction of RNG data.
		  <p><b>Consequences:</b> This might lead to key compromise situation [<a href="#dfn-t-1.4.2" class="internalDFN">T-1.4.2</a>] when 
		    using ECDSA (if the k value is used multiple times or if it is predictable).</p>
		  <p><b>Mitigations:</b> Proper robustness of the Authenticator's RNG and verification of the relevant 
		    operating environment parameters (e.g. temperature, ...).</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.11</th><th>Firmware Rollback</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td></td>
		<td>Attacker might be able to install a previous and potentially buggy version of the firmware.
		  <p><b>Consequences:</b> This might lead to successful attacks, e.g. T-1.4.9.</p>
		  <p><b>Mitigations:</b> Proper robustness firmware update and verification method.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.12</th><th>User Verification Data Injection</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>Attacker might be able to inject pre-captured user verification data into the 
		  Authenticator. For example, if a password is used as user verification method, the attacker 
		  could capture the password entered by the user and then send the correct password 
		  to the Authenticator (by-passing the expected keyboard/PIN pad).  Passwords could 
		  be captured ahead of the attack e.g. by convincing the user to enter the password into 
		  a malicious app (“phishing”) or by spying directly or indirectly the password data.
		  <p> In another example, some malware could play an audio stream which would be recorded 
		    by the microphone and used by a Speaker-Recognition based Authenticator.</p>
		  <p><b>Consequences:</b> This might lead to successful user impersonation (if the attacker has 
		    access to valid user verification data).</p>
		  <p><b>Mitigations:</b> Use a physically secured user verification input method, 
		    e.g. Fingerprint Sensor or Trusted-User-Interface for PIN entry which cannot be 
		    by-passed by malware.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.13</th><th>Verification Reference Data Modification</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>An attacker gains logical or physical access to the Authenticator and modifies 
		  Verification Reference Data (e.g. hashed PIN value, fingerprint templates) 
		  stored in the Authenticator and 
		  adds reference data known to or reproducible by the attacker.  
		  <p><b>Consequences:</b> The attacker would be recognized as the legitimate User 
		    and could impersonate the user.</p>
		  <p><b>Mitigations:</b> [<a href="#dfn-sm-27" class="internalDFN">SM-27</a>] Proper protection of the the verification reference data and biometric data
		    in the Authenticator.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.14</th><th>Read access to captured user verification data</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>The Attacker gained read access to the captured user verification data 
		  (e.g. PIN, fingerprint image, ...).
		  <p><b>Consequences:</b> The attacker gets access to PII and could disclose it violating [<a href="#dfn-sg-8" class="internalDFN">SG-8</a>].</p>
		  <p><b>Mitigations:</b> Limiting access to the user verification data to the Authenticator exclusively.</p>
		</td>
		<td><a href="#dfn-sg-8" class="internalDFN">SG-8</a></td>
	      </tr>
	    </tbody>
	  </table>
	  
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.15</th><th>Compromised the internal PRNG state and the entropy source</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a>, <a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td> In this threat, an attacker compromises the entropy source prior to the Authenticator initially seeding the PRNG during
 		  initialization or otherwise compromises the internal PRNG state, and the attacker is able to know or specify all future
 		  entropy inputs to the PRNG. No PRNG is able to recover to a secure status under this threat, but it serves as a useful
 		  point for comparison.  
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>], [<a href="#dfn-sg-3" class="internalDFN">SG-3</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> 
		    This constitutes a complete compromise of the RNG, with no ability to recover, so mitigation for this threat involves
		    reducing the impact of a compromised RNG. This is partially mitigated by using an allowed random number generator that
 		    allows secure integration of additional input [<a href="#dfn-sm-16" class="internalDFN">SM-16</a>] and introduction of data derived from the RP challenge additional
 		    input to the PRNG, which can help so long as the attacker has not additionally compromised the TLS session or
 		    the ASM / Authenticator link. Using the deterministic signature generation methods (e.g., RFC 6979) can reduce the risk of
 		    compromise of existing keys during the signature process, as can using the private key and hash of the signed message as
 		    additional input to the PRNG during signature generation. Prevention of non-scalable versions of this style of attack is
 		    at least partially addressed by [<a href="#dfn-sm-17" class="internalDFN">SM-17</a>] and [<a href="#dfn-sm-18" class="internalDFN">SM-18</a>].</p></td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-2" class="internalDFN">SG-2</a>, <a href="#dfn-sg-3" class="internalDFN">SG-3</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.16</th><th>Compromised entropy source after successful seeding during initialization</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a>, <a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td>
		  In this threat, an attacker gains the ability to influence the Authenticator’s entropy source, but only after the initial
 		  seeding has been conducted (e.g., if initial seeding occurred prior to the attack and / or as per-Authenticator factory
 		  injection of entropy). 
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>], [<a href="#dfn-sg-3" class="internalDFN">SG-3</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> This is mitigated by using an allowed PRNG which retains PRNG state between power cycles; i.e., which
 		    conserves PRNG state even when being reseeded [<a href="#dfn-sm-16" class="internalDFN">SM-16</a>]. Prevention of non-scalable versions of this style of attack is at
 		    least partially addressed by [<a href="#dfn-sm-17" class="internalDFN">SM-17</a>] and [<a href="#dfn-sm-18" class="internalDFN">SM-18</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-2" class="internalDFN">SG-2</a>, <a href="#dfn-sg-3" class="internalDFN">SG-3</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.17</th><th>Compromised the internal PRNG state, but not the entropy source</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a>, <a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td>In this threat, an attacker compromises the entropy source prior to seeding the PRNG or otherwise compromises the internal
 		  PRNG state, but then at some point, the attacker no longer can access / control the entropy source. 
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>], [<a href="#dfn-sg-3" class="internalDFN">SG-3</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>]</p>
		  <p><b>Mitigations:</b> This can be mitigated by Authenticators reseeding periodically from an internal entropy
 		    source [<a href="#dfn-sm-16" class="internalDFN">SM-16</a>]. As a note, this imposes a total number of random number generator requests prior to a required reseed
 		    event; in the event that the Authenticator does not have an entropy source internally, this may act as a hard limit on the
 		    number of registrations / authentications that such an Authenticator can perform. Prevention of non-scalable versions of
 		    this style of attack is at least partially addressed by [<a href="#dfn-sm-17" class="internalDFN">SM-17</a>] and [<a href="#dfn-sm-18" class="internalDFN">SM-18</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-2" class="internalDFN">SG-2</a>, <a href="#dfn-sg-3" class="internalDFN">SG-3</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.18</th><th>Bad Key Generation</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a>, <a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td> In this threat, random chance or active attack causes the key generated to be cryptographically flawed; e.g., an RSA key
 		  that can be factored using the Pollard p-1 algorithm more quickly than with the General Number Field Sieve. See also
		  <a href="#dfn-t-1.4.21" class="internalDFN">T-1.4.21</a>.
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>]</p>
		  <p><b>Mitigations:</b> This is mitigated by requiring use of an allowed random number 
		    generator (in the case of certified authenticators),
		    requiring that keys be generated in the way required in the relevant standard specified in the
		    Allowed Cryptography List [<a href="#dfn-sm-16" class="internalDFN">SM-16</a>], and making the key
 		    generation process resistant to tampering by the attacker [<a href="#dfn-sm-18" class="internalDFN">SM-18</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-2" class="internalDFN">SG-2</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.19</th><th>Local external side channel attacks</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a> (associated with shared keys), <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td> In this threat, an attacker with possession of the Authenticator may be able to extract keys using timing, power, RF, or
 		  near-field analysis. The impact depends on the key or secret recovered. 
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p> 
		  <p><b>Mitigations:</b> This is mitigated by the side channel resistance security measure [<a href="#dfn-sm-17" class="internalDFN">SM-17</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-2" class="internalDFN">SG-2</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.20</th><th>Internal side channel attacks</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a> (associated with shared keys), <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td> In this threat, an attacker controlling a process running on the same hardware 
		  environment as the Authenticator may be able
 		  to recover keys by using information leaked by hardware or operating system characteristics (e.g., how often the
 		  attacker’s process is scheduled, the state of the L1, L2 caches, etc.). 
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> This is mitigated by the side channel resistance security measure [<a href="#dfn-sm-17" class="internalDFN">SM-17</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th><dfn id="dfn-t-1.4.21">T-1.4.21</dfn></th><th>Error injection during key or signature generation</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a> (associated with shared keys), <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td>In this threat, an attacker is able to inject an error in the key or 
		  signature generation process that leaks part or all of the private key. 
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> This is mitigated by [<a href="#dfn-sm-18" class="internalDFN">SM-18</a>] and [<a href="#dfn-sm-28" class="internalDFN">SM-28</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.22</th><th>Birthday Paradox Collision</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>In this threat, a set of randomly generated parameters collide. 
		  The probability of this occurrence can be bounded using
 		  analysis similar to that associated with the classical Birthday Paradox.
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> Establishing a bounded number of allowable 
		    outputs based on the size of the randomly generated value
 		    [<a href="#dfn-sm-19" class="internalDFN">SM-19</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.23</th><th>Privacy Reduction</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a></td>
		<td>In this threat, a small number of Authenticators share an attestation 
		  key which leaks information about the user across
 		  Relying Parties. 
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>].</p>
		  <p><b>Mitigations:</b> This is mitigated by [<a href="#dfn-sm-20" class="internalDFN">SM-20</a>].</p>
		</td>
		<td><a href="#dfn-sg-4" class="internalDFN">SG-4</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.24</th><th>Covert Channel</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a></td>
		<td>In this threat, an Authenticator is malicious (either by design, 
		  or after having been independently compromised) and it is
 		  configured to leak secret or identifying data within apparently normal exchanges, or to other processes on the same
 		  hardware platform as the Authenticator. 
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], 
		    [<a href="#dfn-sg-5" class="internalDFN">SG-5</a>], [<a href="#dfn-sg-6" class="internalDFN">SG-6</a>], [<a href="#dfn-sg-8" class="internalDFN">SG-8</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> Note: This is an interesting thought experiment; use of random nonces and other
		    non-deterministic elements make protection against this threat problematic.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-5" class="internalDFN">SG-5</a>, <a href="#dfn-sg-6" class="internalDFN">SG-6</a>, <a href="#dfn-sg-8" class="internalDFN">SG-8</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.25</th><th>Subsitution of Protected Information</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a>, <a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>In this threat, an attacker substitutes protected information, 
		  either by modifying it piecemeal, or by completely
 		  substituting it with another value. (Some encryption modes allow an 
		  attacker to target bit-level changes to the plaintext.
 		  Authenticated data may also have been replaced with data that had 
		  previously been authenticated in the same way.)
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> This threat is mitigated by [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>], [<a href="#dfn-sm-16" class="internalDFN">SM-16</a>], [<a href="#dfn-sm-21" class="internalDFN">SM-21</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.26</th><th>Compromise of Protected Information</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a>, <a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>In this threat, an attacker recovers data that should be protected by the Authenticator.
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>], 
		    [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-5" class="internalDFN">SG-5</a>], [<a href="#dfn-sg-7" class="internalDFN">SG-7</a>], [<a href="#dfn-sg-8" class="internalDFN">SG-8</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> This threat is mitigated by using allowed 
		    cryptographic primitives [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>], [<a href="#dfn-sm-16" class="internalDFN">SM-16</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-2" class="internalDFN">SG-2</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-5" class="internalDFN">SG-5</a>, <a href="#dfn-sg-7" class="internalDFN">SG-7</a>, <a href="#dfn-sg-8" class="internalDFN">SG-8</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.27</th><th>Signature or registration counter non-monotonicity</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a></td>
		<td>In this threat, an attacker may be able to cause these counters to be reset, 
		  to roll over, or otherwise to decrease in value.
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-12" class="internalDFN">SG-12</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> This threat is mitigated by [<a href="#dfn-sm-15" class="internalDFN">SM-15</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-12" class="internalDFN">SG-12</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.28</th><th>Hostile ASM / Client</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>In this threat, the Authenticator support infrastructure is hostile, 
		  and can feed arbitrary data to the Authenticator. 
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-5" class="internalDFN">SG-5</a>], [<a href="#dfn-sg-7" class="internalDFN">SG-7</a>], [<a href="#dfn-sg-8" class="internalDFN">SG-8</a>].</p>
		  <p><b>Mitigations:</b> This threat is mitigated by [<a href="#dfn-sm-10" class="internalDFN">SM-10</a>], [<a href="#dfn-sm-13" class="internalDFN">SM-13</a>].</p>
		</td>
		<td><a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-5" class="internalDFN">SG-5</a>, <a href="#dfn-sg-7" class="internalDFN">SG-7</a>, <a href="#dfn-sg-8" class="internalDFN">SG-8</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.29</th><th>Debug Interface</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a> (associated with shared keys), <a href="#dfn-ac3" class="internalDFN">AC3</a> 
		  (associated with shared keys), <a href="#dfn-ac5" class="internalDFN">AC5</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>In this threat, the Authenticator has a hardware or software debugging 
		  interface that is not completely disabled prior to
 		  distribution of the Authenticator (e.g., pads for a JTAG port).
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], 
		    [<a href="#dfn-sg-5" class="internalDFN">SG-5</a>], [<a href="#dfn-sg-6" class="internalDFN">SG-6</a>], [<a href="#dfn-sg-8" class="internalDFN">SG-8</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> This threat is mitigated by [<a href="#dfn-sm-18" class="internalDFN">SM-18</a>], [<a href="#dfn-sm-22" class="internalDFN">SM-22</a>], and [<a href="#dfn-sm-28" class="internalDFN">SM-28</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-5" class="internalDFN">SG-5</a>, <a href="#dfn-sg-6" class="internalDFN">SG-6</a>, <a href="#dfn-sg-8" class="internalDFN">SG-8</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.30</th><th>Fault induced by malformed input</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>In this threat, the Authenticator behaves in an unexpected fashion 
		  due to an error in processing malformed input. The result
		  of this style of attack is poorly controllable, absent strong internal segmentation of the Authenticator.
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>], 
		    [<a href="#dfn-sg-3" class="internalDFN">SG-3</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-6" class="internalDFN">SG-6</a>], [<a href="#dfn-sg-7" class="internalDFN">SG-7</a>], [<a href="#dfn-sg-8" class="internalDFN">SG-8</a>], 
		    [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>], [SG-16].</p>
		  <p><b>Mitigations:</b> This threat is mitigated by [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>], 
		    [<a href="#dfn-sm-2" class="internalDFN">SM-2</a>], [<a href="#dfn-sm-4" class="internalDFN">SM-4</a>], [<a href="#dfn-sm-5" class="internalDFN">SM-5</a>], [<a href="#dfn-sm-10" class="internalDFN">SM-10</a>], 
		    [<a href="#dfn-sm-5" class="internalDFN">SM-5</a>], [<a href="#dfn-sm-23" class="internalDFN">SM-23</a>], [<a href="#dfn-sm-13" class="internalDFN">SM-13</a>], [<a href="#dfn-sm-26" class="internalDFN">SM-26</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-2" class="internalDFN">SG-2</a>, <a href="#dfn-sg-3" class="internalDFN">SG-3</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-6" class="internalDFN">SG-6</a>, 
		  <a href="#dfn-sg-7" class="internalDFN">SG-7</a>, <a href="#dfn-sg-8" class="internalDFN">SG-8</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a>, SG-16</td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.31</th><th>Fault Injection Attack</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a> (associated with shared keys), <a href="#dfn-ac5" class="internalDFN">AC5</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		<td>In this threat, an attacker subjects the Authenticator to conditions 
		  that induce hardware faults (e.g., exposure to photons
 		  or charged particles, inducing variations in supply voltage or external clock, 
		  altering the temperature, etc.) in an attempt
 		  to subvert some logical or physical protection. The result of this style of 
		  attack is poorly controllable, absent active
 		  detection and response functionality within the Authenticator. 
		  This is related to <a href="#dfn-t-1.4.21" class="internalDFN">T-1.4.21</a>, but applies more broadly.
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>], [<a href="#dfn-sg-3" class="internalDFN">SG-3</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], 
		    [<a href="#dfn-sg-6" class="internalDFN">SG-6</a>], [<a href="#dfn-sg-7" class="internalDFN">SG-7</a>], [<a href="#dfn-sg-8" class="internalDFN">SG-8</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>], [SG-16].</p>
		  <p><b>Mitigations:</b> Mitigated by [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>], [<a href="#dfn-sm-2" class="internalDFN">SM-2</a>], [<a href="#dfn-sm-4" class="internalDFN">SM-4</a>], 
		    [<a href="#dfn-sm-5" class="internalDFN">SM-5</a>], [<a href="#dfn-sm-10" class="internalDFN">SM-10</a>], [<a href="#dfn-sm-5" class="internalDFN">SM-5</a>], [<a href="#dfn-sm-18" class="internalDFN">SM-18</a>], [<a href="#dfn-sm-23" class="internalDFN">SM-23</a>], [<a href="#dfn-sm-13" class="internalDFN">SM-13</a>], [<a href="#dfn-sm-26" class="internalDFN">SM-26</a>],
 		    [<a href="#dfn-sm-28" class="internalDFN">SM-28</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-2" class="internalDFN">SG-2</a>, <a href="#dfn-sg-3" class="internalDFN">SG-3</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-6" class="internalDFN">SG-6</a>, <a href="#dfn-sg-7" class="internalDFN">SG-7</a>, 
		  <a href="#dfn-sg-8" class="internalDFN">SG-8</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a>, SG-16</td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-1.4.32</th><th>Remote Timing Attacks</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td>In this threat, an attacker may be able to extract keys using a timing 
		  attack from a remote location. The impact depends on
 		  the key or secret recovered.
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], 
		    [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p><b>Mitigations:</b> This threat is mitigated by the remote timing attack 
		    resistance security measure [<a href="#dfn-sm-29" class="internalDFN">SM-29</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-2" class="internalDFN">SG-2</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>
	      </tr>
	    </tbody>
	  </table>
	</section>

	<section id="threats-to-relying-party">
	  <h4 aria-level="3" role="heading" id="h4_threats-to-relying-party"><span class="secno">7.1.5 </span>Threats to Relying Party</h4>

	  <section id="threats-to-fido-server-data">
	    <h5 aria-level="4" role="heading" id="h5_threats-to-fido-server-data"><span class="secno">7.1.5.1 </span>Threats to FIDO Server Data</h5>

	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-2.1.1</th><th>FIDO Server DB Read Attack</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td></td>
		  <td>Attacker could obtains read-access to FIDO Server registration database.
		    <p><b>Consequences:</b>Attacker can access all cryptographic key handles 
		      and authenticator characteristics
		      associated with a username. If an authenticator or combination of authenticators
		      is unique, they might use this to try to violate [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>] Unlinkability.</p>
		    <p>Attacker attempts to perform factorization of public keys by virtue of having access
		      to a large corpus of data, violating [<a href="#dfn-sg-5" class="internalDFN">SG-5</a>] Verifier Leak Resiliance and
		      [<a href="#dfn-sg-2" class="internalDFN">SG-2</a>] Credential Guessing Resilience.</p>
		    <p><b>Mitigations:</b> [<a href="#dfn-sm-2" class="internalDFN">SM-2</a>] Unique Authentication Keys help prevent disclosed key material from
		      being useful against any other Relying Party, even if successfully attacked.</p>
		    <p>The use of an [<a href="#dfn-sm-6" class="internalDFN">SM-6</a>] Cryptographically Secure Verifier Database helps assure
		      that it is infeasible to attack any leaked verifier keys.</p>
		    <p>[<a href="#dfn-sm-9" class="internalDFN">SM-9</a>] Authenticator Certification along with [<a href="#dfn-sm-16" class="internalDFN">SM-16</a>] 
		      should help prevent authenticators with poor
		      entropy from entering the market, reducing the likelihood that even a large corpus
		      of key material will be useful in mounting attacks.</p>	
		  </td>
		  <td><a href="#dfn-sg-2" class="internalDFN">SG-2</a>, <a href="#dfn-sg-5" class="internalDFN">SG-5</a></td>
		</tr>
	      </tbody>
	    </table>
	    
	    <p></p>
	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-2.1.2</th><th>FIDO Server DB Modification Attack</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td><a href="#dfn-ac1" class="internalDFN">AC1</a></td>
		  <td>Attacker gains write-access to the FIDO Server registration database.
		    <p><b>Consequences:</b> Violation of [<a href="#dfn-sa-6" class="internalDFN">SA-6</a>]</p>
		    <p>The attacker may inject a key registration under its control, violating [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>]
		      Strong User Authentication.</p>
		    <p><b>Mitigations:</b> Mitigating such attacks is outside the scope of the FIDO specifications. 
		      The Relying Party must maintain the integrity of any information it relies 
		      up on to identify a user as part of [<a href="#dfn-sa-6" class="internalDFN">SA-6</a>].</p>
		  </td>
		  <td><a href="#dfn-sa-6" class="internalDFN">SA-6</a></td>
		</tr>
	      </tbody>
	    </table>
	    
	    <p></p>
	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-2.2.1</th><th>Web App Malware</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td></td>
		  <td>Attacker gains ability to execute code in the security context of the Relying Party
		    web application or FIDO Server.
		    <p><b>Consequences:</b> Attacker is able to violate [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-10" class="internalDFN">SG-10</a>], [<a href="#dfn-sg-9" class="internalDFN">SG-9</a>] 
		      and any other Relying Party controls.</p>
		    <p><b>Mitigations:</b> The consequences of such an incident are limited to the relationship 
		      between the user and that particular Relying Party by [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>], [<a href="#dfn-sm-2" class="internalDFN">SM-2</a>], and [<a href="#dfn-sm-5" class="internalDFN">SM-5</a>].</p>
		    <p>Even within the Relying Party to user relationship, a user can be protected by
		      [<a href="#dfn-sm-10" class="internalDFN">SM-10</a>] Transaction Confirmation if the compromise does not include the
		      users' computing environment.</p>
		  </td>
		  <td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-9" class="internalDFN">SG-9</a>, <a href="#dfn-sg-10" class="internalDFN">SG-10</a></td>
		</tr>
	      </tbody>
	    </table>

	    <p></p>
	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-2.2.2</th><th>Linking through compromised Relying Party database</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td><a href="#dfn-ac1" class="internalDFN">AC1</a></td>
		  <td>In this threat, a Relying Party is able to access another Relying Party’s 
		    database (either because the Relying Parties are
 		    collaborating or because of the compromise of another Relying Party’s database). 
		    The malicious party then sends Key Handles
 		    (which may contain a wrapped private key) from the other Relying Party’s 
		    database in an attempt to link the two separate
 		    accounts to the same Authenticator (thus user).
		    <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>].</p>
		    <p><b>Mitigations:</b> This threat is mitigated by [<a href="#dfn-sm-1" class="internalDFN">SM-1</a>], [<a href="#dfn-sm-2" class="internalDFN">SM-2</a>], 
		      [<a href="#dfn-sm-5" class="internalDFN">SM-5</a>], [<a href="#dfn-sm-23" class="internalDFN">SM-23</a>].</p>
		  </td>
		  <td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a></td>
		</tr>
	      </tbody>
	    </table>
	  </section>

	</section>

	<section id="threats-to-the-secure-channel-between-client-and-relying-party">
	  <h4 aria-level="3" role="heading" id="h4_threats-to-the-secure-channel-between-client-and-relying-party"><span class="secno">7.1.6 </span>Threats to the Secure Channel between Client and Relying Party</h4>

	  <section id="exploiting-weaknesses-in-the-secure-transport-of-fido-messages">
	    <h5 aria-level="4" role="heading" id="h5_exploiting-weaknesses-in-the-secure-transport-of-fido-messages"><span class="secno">7.1.6.1 </span>Exploiting Weaknesses in the Secure Transport of FIDO Messages</h5>
	    FIDO takes as a base assumption that [<a href="#dfn-sa-3" class="internalDFN">SA-3</a>] applications on the user device are able
	    to establish secure channels that provide trustworthy server authentication, and confidentiality
	    and integrity for messages. e.g. through TLS. [<a href="#dfn-t-1.2.4" class="internalDFN">T-1.2.4</a>] Discusses some consequences
	    of violations of this assumption due to implementation errors in a browser or
	    client application, but other threats exist in different layers.

	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-3.1.1</th><th>TLS Proxy</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		  <td>The FIDO user device is administratively configured to connect through a proxy that terminates
		    TLS connections. The client trusts this device, but the connection between
		    the user and FIDO server is no longer end-to-end secure.
		    <p><b>Consequences:</b> Any such proxies introduce a new party into the protocol. 
		      If this party is untrustworthy, consequences may be as for [<a href="#dfn-t-1.2.4" class="internalDFN">T-1.2.4</a>].</p>
		    <p><b>Mitigations:</b> Mitigations for [<a href="#dfn-t-1.2.4" class="internalDFN">T-1.2.4</a>] apply, except that the proxy 
		      is considered trusted by the client, so certain methods of [<a href="#dfn-sm-12" class="internalDFN">SM-12</a>] Channel Binding 
		      may indicate a compromised channel even in the absence of an attack. Servers should use multiple
		      methods and adjust their risk scoring appropriately. A trustworthy client that reports
		      a server certificate that is unknown to the server and does not chain to a
		      public root may indicate a client behind such a proxy. A client reporting a server
		      certificate that is unknown to the server but validates for the server's identity according
		      to commonly used public trust roots is more likely to indicate [<a href="#dfn-t-3.1.2" class="internalDFN">T-3.1.2</a>].</p>
		  </td>
		  <td><a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-12" class="internalDFN">SG-12</a>, <a href="#dfn-sg-13" class="internalDFN">SG-13</a></td>
		</tr>
	      </tbody>
	    </table>
	    
	    <p></p>
	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th><dfn id="dfn-t-3.1.2">T-3.1.2</dfn></th><th>Fraudulent TLS Server Certificate</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		  <td>An attacker is able to obtain control of a certificate credential for a Relying Party,
		    perhaps from a compromised Certification Authority or poor protection practices
		    by the Relying Party.
		    <p><b>Consequences:</b>As for [<a href="#dfn-t-1.2.4" class="internalDFN">T-1.2.4</a>].</p>
		    <p><b>Mitigations:</b>As for [<a href="#dfn-t-1.2.4" class="internalDFN">T-1.2.4</a>].</p>
		  </td>
		  <td><a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-12" class="internalDFN">SG-12</a>, <a href="#dfn-sg-13" class="internalDFN">SG-13</a></td>
		</tr>
	      </tbody>
	    </table>

	    <p></p>
	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-3.1.3</th><th>Protocol level real-time MITM attack</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td><a href="#dfn-ac3" class="internalDFN">AC3</a></td>
		  <td>An adversary can intercept and manipulate network packets sent from the relying party to the client.
		    The adversary uses this capability to (a) terminate the underlying TLS session from the client at 
		    the adversary and to (b) simultaneously use another TLS session from the adversary to the relying party.
		    In the traditional username/password world, this allows the adversary to intercept the username 
		    and the password and then successfully impersonate the user at the relying party.
		    <p><b>Consequences:</b> None if FIDO channelBinding [<a href="#dfn-sm-12" class="internalDFN">SM-12</a>] or transaction confirmation [<a href="#dfn-sm-10" class="internalDFN">SM-10</a>] 
		      are used.</p>
		    <p><b>Mitigations:</b> 
		      In the case of channelBinding [<a href="#dfn-sm-12" class="internalDFN">SM-12</a>], the FIDO server will detect the MITM in the 
		      TLS channel by comparing the channel binding information provided by the client 
		      and the channel binding information retrieved locally by the server.</p>
		    <p>In the case of transaction confirmation [<a href="#dfn-sm-10" class="internalDFN">SM-10</a>], the user verifies and approves 
		      a particular transaction. The adversary could modify the transaction before approval.  
		      This would lead to rejection by the user.  
		      Alternatively, the adversary could modify the transaction after approval.  
		      This will break the signature in the transaction confirmation response.  The FIDO Server
		      will not accept it as a consequence. </p>
		    <p>HTTP Public Key Pinning (RFC7469) can also be used to mitigate this attack (outside the FIDO stack).
		    </p>
		  </td>
		  <td><a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-12" class="internalDFN">SG-12</a>, <a href="#dfn-sg-13" class="internalDFN">SG-13</a></td>
		</tr>
	      </tbody>
	    </table>


	  </section>
	</section>

	<section id="threats-to-the-infrastructure">
	  <h4 aria-level="3" role="heading" id="h4_threats-to-the-infrastructure"><span class="secno">7.1.7 </span>Threats to the Infrastructure</h4>

	  <section id="threats-to-fido-authenticator-manufacturers">
	    <h5 aria-level="4" role="heading" id="h5_threats-to-fido-authenticator-manufacturers"><span class="secno">7.1.7.1 </span>Threats to FIDO Authenticator Manufacturers</h5>

	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-4.1.1</th><th>Manufacturer Level Attestation Key Compromise</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td><a href="#dfn-ac2" class="internalDFN">AC2</a></td>
		  <td>Attacker obtains control of an attestation key or attestation key issuing key.
		    <p><b>Consequences:</b> Same as [<a href="#dfn-t-1.4.6" class="internalDFN">T-1.4.6</a>]:
		      Attacker can violate [<a href="#dfn-sg-9" class="internalDFN">SG-9</a>] Attestable Properties by creating a malicious 
		      hardware or software device that represents itself as a legitimate one.</p>
		    <p><b>Mitigations:</b> Same as [<a href="#dfn-t-1.4.6" class="internalDFN">T-1.4.6</a>]: Relying Parties can use [<a href="#dfn-sm-4" class="internalDFN">SM-4</a>] 
		      Authenticator Status Checking to identify known-compromised keys. 
		      Identification of such compromise is outside the strict scope of the FIDO protocols.</p>
		  </td>
		  <td><a href="#dfn-sg-9" class="internalDFN">SG-9</a></td>
		</tr>
	      </tbody>
	    </table>
	    
	    <p></p>
	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-4.1.2</th><th>Malicious Authenticator HW</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td><a href="#dfn-ac1" class="internalDFN">AC1</a>, <a href="#dfn-ac2" class="internalDFN">AC2</a>, <a href="#dfn-ac3" class="internalDFN">AC3</a>, <a href="#dfn-ac5" class="internalDFN">AC5</a>, <a href="#dfn-ac6" class="internalDFN">AC6</a></td>
		  <td>FIDO Authenticator manufacturer relies on hardware or software components
		    that generate weak cryptographic authentication key material or contain backdoors.
		    <p><b>Consequences:</b> Effective violation of [<a href="#dfn-sa-1" class="internalDFN">SA-1</a>] in the context of such an Authenticator.</p>
		    <p><b>Mitigations:</b> The process of [<a href="#dfn-sm-9" class="internalDFN">SM-9</a>] Authenticator Certification may reveal a subset of such
		      threats, but it is not possible that all such can be revealed with black box testing
		      and white box examination may be is economically infeasible. Users and Relying
		      Parties with special concerns about this class of threat must exercise their own
		      necessary caution about the trustworthiness and verifiability of their vendors and
		      supply chain. [<a href="#dfn-sm-24" class="internalDFN">SM-24</a>] builds confidence that an Authenticator is not 
		      malicious or poorly implemented.</p>
		  </td>
		  <td><a href="#dfn-sa-1" class="internalDFN">SA-1</a></td>
		</tr>
	      </tbody>
	    </table>
	  </section>

	  <section id="threats-to-fido-server-vendors">
	    <h5 aria-level="4" role="heading" id="h5_threats-to-fido-server-vendors"><span class="secno">7.1.7.2 </span>Threats to FIDO Server Vendors</h5>

	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-4.2.1</th><th>Vendor Level Trust Anchor Injection Attack</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td></td>
		  <td>Attacker adds malicious trust anchors to the trust list shipped by a FIDO Server
		    vendor.
		    <p><b>Consequences:</b> Attacker can deploy fake Authenticators which Relying Parties cannot detect as
		      such, which do not implement any appropriate security measures, and is able to
		      violate all security goals of FIDO.</p>
		    <p><b>Mitigations:</b> This type of supply chain threat is outside the strict scope 
		      of the FIDO protocols and violates [<a href="#dfn-sa-6" class="internalDFN">SA-6</a>]. Relying Parties can verify their 
		      trust list against the data published by the <abbr title="FIDO Alliance">FIDO Alliance</abbr> Metadata Service [<cite><a class="bibref" href="#bib-FIDOMetadataService">FIDOMetadataService</a></cite>] 
		      (see <code>https://fidoalliance.org/mds</code>).
		    </p>
		  </td>
		  <td><a href="#dfn-sa-6" class="internalDFN">SA-6</a></td>
		</tr>
	      </tbody>
	    </table>
	  </section>

	  <section id="threats-to-fido-metadata-service-operators">
	    <h5 aria-level="4" role="heading" id="h5_threats-to-fido-metadata-service-operators"><span class="secno">7.1.7.3 </span>Threats to FIDO Metadata Service Operators</h5>

	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-4.3.1</th><th>Metadata Service Signing Key Compromise</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td></td>
		  <td>The attacker gets access to the private Metadata TOC signing key.
		    <p><b>Consequences:</b> The attacker could sign invalid Metadata.  The attacker could</p>
		      <ul>
			<li>make trustworthy authenticators look less trustworthy (e.g. by increasing FAR).</li>
			<li>make weak authenticators look strong (e.g. by changing the key protection 
			  method to a more secure one)</li>
			<li>inject malicious attestation trust anchors, e.g. root certificates which 
			  cross-signed the original attestation trust anchor and the cross-signed 
			  original attestation root certificate.  This malicious
			  trust anchors could be used to sign attestation certificates for fraudulent 
			  authenticators, e.g. authenticators using the AAID of trustworthy authenticators 
			  but not protecting their keys as stated in the metadata.
		      </li></ul>
		    <p><b>Mitigations:</b> The Metadata Service operator should protect the Metadata 
		      signing key appropriately, e.g. using a hardware protected key storage.</p>
		    <p>Relying parties could use out-of-band methods to cross-check Metadata Statements 
		      with the respective vendors and cross-check the revocation state of the 
		      Metadata signing key with the provider of the Metadata Service.
		    </p>
		  </td>
		  <td><a href="#dfn-sg-9" class="internalDFN">SG-9</a></td>
		</tr>
	      </tbody>
	    </table>
	    
	    <p></p>
	    <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	      <thead>
		<tr><th>T-4.3.2</th><th>Metadata Statement Data Injection</th><th>Violates</th></tr>
	      </thead>
	      <tbody>
		<tr>
		  <td></td>
		  <td>An attacker injects malicious Authenticator data into the Metadata Statement.
		    <p><b>Consequences:</b> The attacker could make the Metadata Service operator sign 
		      invalid Metadata Statements.  The attacker could </p>
		      <ul>
			<li>make trustworthy authenticators look less trustworthy (e.g. by increasing FAR).</li>
			<li>make weak authenticators look strong (e.g. by changing the key protection 
			  method to a more secure one)</li>
			<li>inject malicious attestation trust anchors, e.g. root certificates which 
			  cross-signed the original attestation trust anchor and the cross-signed 
			  original attestation root certificate.  This malicious
			  trust anchors could be used to sign attestation certificates for 
			  fraudulent authenticators, e.g. authenticators using the AAID of 
			  trustworthy authenticators but not protecting their keys as stated in the metadata.
		      </li></ul>
		    <p><b>Mitigations:</b> The Metadata Service operator could carefully review the 
		      delta between the old and the new Metadata Statements.  Authenticator vendors could verify 
		      the published Metadata Statements related to their Authenticators.</p>
		  </td>
		  <td><a href="#dfn-sg-9" class="internalDFN">SG-9</a></td>
		</tr>
	      </tbody>
	    </table>
	  </section>
	</section>

	<section id="threats-specific-to-second-factor-authenicators-uaf-u2f">
	  <h4 aria-level="3" role="heading" id="h4_threats-specific-to-second-factor-authenicators-uaf-u2f"><span class="secno">7.1.8 </span>Threats Specific to Second Factor Authenicators (UAF / U2F)</h4>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-5.1.1</th><th>Error Status Side Channel</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td></td>
		<td>Relying parties issues an authentication challenge to an authenticator and can infer
		  from error status if it is already registered.
		  <p><b>Consequences:</b> UAF Silent authenticators / U2F authenticators not requiring 
		    user interaction for generating a signed response may be used to track users
		    without their consent by issuing a pre-authentication challenge to them,
		    revealing the identity of an otherwise anonymous user. Users would be identifiable
		    by relying parties without their knowledge, violating [<a href="#dfn-sg-7" class="internalDFN">SG-7</a>].</p>
		  <p><b>Mitigations:</b> The U2F specification recommends that browsers prompt users whether to allow
		    this operation using mechanisms similar to those defined for other privacy sensitive
		    operations like Geolocation.  </p>
		</td>
		<td><a href="#dfn-sg-7" class="internalDFN">SG-7</a></td>
	      </tr>
	    </tbody>
	  </table>
	  
	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-5.1.2</th><th>Malicious RP</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac1" class="internalDFN">AC1</a></td>
		<td>Malicious relying party mounts a cryptographic attack on a key handle it is storing.
		  <p><b>Consequences:</b> If the Relying Party is able to recover the contents of the key handle, it
		    might forge logs of protocol exchanges to associate the user with actions he or
		    she did not perform.</p>
		  <p>If the Relying Party is able to recover the key used to wrap a key handle, that key
		    is likely used for all key handles, and hence might be used to decrypt key handles stored with other Relying
		    Parties and violate [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>] Strong User Authentication.</p>
		  <p><b>Mitigations:</b> None. U2F depends on [<a href="#dfn-sa-1" class="internalDFN">SA-1</a>] to hold for key wrapping operations.
		  </p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-5.1.3</th><th>Physical Attack on a User Presence Authenticator</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td>Attacker gains physical access to U2F authenticator or a UAF authenticator with only user presence
		  check (e.g., by stealing it).
		  <p><b>Consequences:</b> Same as for [<a href="#dfn-t-1.4.4" class="internalDFN">T-1.4.4</a>].
		  </p><p>Such authenticators have weak local user verification. If the attacker can guess
		    the username and password/PIN, they can impersonate the user, violating [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>]
		    Strong User Authentication.</p>
		  <p><b>Mitigations:</b> Relying Parties can use strong additional factors.</p>
		  <p>Relying Parties should provide users a means to revoke keys associated with a
		    lost device.</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a></td>
	      </tr>
	    </tbody>
	  </table>

	  <p></p>
	  <table class="threats"><colgroup width="100%"><col width="5em"><col><col width="5em"></colgroup>
	    <thead>
	      <tr><th>T-5.1.4</th><th>Physical Attack</th><th>Violates</th></tr>
	    </thead>
	    <tbody>
	      <tr>
		<td><a href="#dfn-ac2" class="internalDFN">AC2</a> (associated with shared keys), <a href="#dfn-ac5" class="internalDFN">AC5</a></td>
		<td>In this threat, keys or other sensitive information is read out by directly 
		  accessing it from the authenticator that the attacker has
 		  physically compromised.
		  <p><b>Consequences:</b> May undermine [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>], [<a href="#dfn-sg-4" class="internalDFN">SG-4</a>], [<a href="#dfn-sg-11" class="internalDFN">SG-11</a>], [<a href="#dfn-sg-14" class="internalDFN">SG-14</a>].</p>
		  <p>Authenticator with user presence check have weak local user verification. If the attacker can guess
		    the username and password/PIN, they can impersonate the user, violating [<a href="#dfn-sg-1" class="internalDFN">SG-1</a>]
		    Strong User Authentication.</p>
		  <p><b>Mitigations:</b> Mitigated by resistance to injected faults [<a href="#dfn-sm-18" class="internalDFN">SM-18</a>] and [<a href="#dfn-sm-28" class="internalDFN">SM-28</a>].</p>
		</td>
		<td><a href="#dfn-sg-1" class="internalDFN">SG-1</a>, <a href="#dfn-sg-4" class="internalDFN">SG-4</a>, <a href="#dfn-sg-11" class="internalDFN">SG-11</a>, <a href="#dfn-sg-14" class="internalDFN">SG-14</a></td>		
	      </tr>
	    </tbody>
	  </table>
	</section>

      </section>

      <section id="acknowledgements">
	<h3 aria-level="2" role="heading" id="h3_acknowledgements"><span class="secno">7.2 </span>Acknowledgements</h3>
	We thank <a href="https://www.isecpartners.com">iSECpartners</a> for their 
	review of, and contributions to, this document.
      </section>

  

</section><section id="references" class="appendix" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><!--OddPage--><h2 aria-level="1" role="heading" id="h2_references"><span class="secno">A. </span>References</h2><section id="informative-references" typeof="bibo:Chapter" resource="#ref" rel="bibo:Chapter"><h3 aria-level="2" role="heading" id="h3_informative-references"><span class="secno">A.1 </span>Informative references</h3><dl class="bibliography" about=""><dt id="bib-FIDOEcdaaAlgorithm">[FIDOEcdaaAlgorithm]</dt><dd rel="dcterms:references">R. Lindemann; J. Camenisch; M. Drijvers; A. Edgington; A. Lehmann; R. Urian. <a href="https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-ecdaa-algorithm-v2.0-ps-20170927.html"><cite>FIDO ECDAA Algorithm</cite></a>. Implementation Draft. URL: <a href="https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-ecdaa-algorithm-v2.0-ps-20170927.html">https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-ecdaa-algorithm-v2.0-ps-20170927.html</a>
</dd><dt id="bib-FIDOGlossary">[FIDOGlossary]</dt><dd rel="dcterms:references">R. Lindemann; D. Baghdasaryan; B. Hill; J. Hodges. <a href="https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-glossary-v2.0-ps-20170927.html"><cite>FIDO Technical Glossary</cite></a>. Implementation Draft. URL: <a href="https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-glossary-v2.0-ps-20170927.html">https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-glossary-v2.0-ps-20170927.html</a>
</dd><dt id="bib-FIDOMetadataService">[FIDOMetadataService]</dt><dd rel="dcterms:references">R. Lindemann; B. Hill; D. Baghdasaryan. <a href="https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-metadata-service-v2.0-ps-20170927.html"><cite>FIDO Metadata Service v1.0</cite></a>. Implementation Draft. URL: <a href="https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-metadata-service-v2.0-ps-20170927.html">https://fidoalliance.org/specs/fido-v2.0-ps-20170927/fido-metadata-service-v2.0-ps-20170927.html</a>
</dd><dt id="bib-PasswordAuthSchemesKeyIssues">[PasswordAuthSchemesKeyIssues]</dt><dd rel="dcterms:references">Chwei-Shyong Tsai; Cheng-Chi Lee; Min-Shiang Hwang. <a href="http://ijns.femto.com.tw/contents/ijns-v3-n2/ijns-2006-v3-n2-p101-115.pdf"><cite>Password Authentication Schemes: Current Status and Key Issues</cite></a>. September 2006. URL: <a href="http://ijns.femto.com.tw/contents/ijns-v3-n2/ijns-2006-v3-n2-p101-115.pdf">http://ijns.femto.com.tw/contents/ijns-v3-n2/ijns-2006-v3-n2-p101-115.pdf</a>
</dd><dt id="bib-QuestToReplacePasswords">[QuestToReplacePasswords]</dt><dd rel="dcterms:references">Joseph Bonneau; Cormac Herley; Paul C. van Oorschot; Frank Stajano. <a href="http://research.microsoft.com/pubs/161585/QuestToReplacePasswords.pdf"><cite>The Quest to Replace Passwords: A Framework for Comparative Evaluation of Web Authentication Schemes</cite></a>. March 2012. URL: <a href="http://research.microsoft.com/pubs/161585/QuestToReplacePasswords.pdf">http://research.microsoft.com/pubs/161585/QuestToReplacePasswords.pdf</a>
</dd><dt id="bib-RFC2119">[RFC2119]</dt><dd rel="dcterms:references">S. Bradner. <a href="https://tools.ietf.org/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
</dd><dt id="bib-U2FOverview">[U2FOverview]</dt><dd rel="dcterms:references">S. Srinivas; D. Balfanz; E. Tiffany. <a href="https://fidoalliance.org/specs/fido-u2f-v1.2-ps-20170411/fido-u2f-overview-v1.2-ps-20170411.html"><cite>FIDO U2F Overview v1.0</cite></a>. Draft. URL: <a href="https://fidoalliance.org/specs/fido-u2f-v1.2-ps-20170411/fido-u2f-overview-v1.2-ps-20170411.html">https://fidoalliance.org/specs/fido-u2f-v1.2-ps-20170411/fido-u2f-overview-v1.2-ps-20170411.html</a>
</dd><dt id="bib-UAFProtocol">[UAFProtocol]</dt><dd rel="dcterms:references">R. Lindemann; D. Baghdasaryan; E. Tiffany; D. Balfanz; B. Hill; J. Hodges. <a href="https://fidoalliance.org/specs/fido-uaf-v1.2-rd-20171128/fido-uaf-protocol-v1.2-rd-20171128.html"><cite>FIDO UAF Protocol Specification v1.0</cite></a>. Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.2-rd-20171128/fido-uaf-protocol-v1.2-rd-20171128.html">https://fidoalliance.org/specs/fido-uaf-v1.2-rd-20171128/fido-uaf-protocol-v1.2-rd-20171128.html</a>
</dd></dl></section></section></body></html>